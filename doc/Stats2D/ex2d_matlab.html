


<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Analysis of 2D data (MATLAB) &#8212; spm1d 0.4 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Documentation (Python)" href="../../Documentation.html" />
    <link rel="prev" title="Analysis of 2D data (Python)" href="ex2d.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../../_static/js/jquery-1.12.4.min.js "></script>
<script type="text/javascript" src="../../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../../_static/bootstrap-3.4.1/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../../_static/bootstrap-sphinx.js "></script>

  </head><body>

<div style="background-color: white; text-align: left; padding: 10px 10px 15px 15px">
<a href="../../index.html"><img src="../../logo.png" border="0" alt="spm1d"/></a>
</div>



  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html">
              </a>
        <span class="navbar-text navbar-version pull-left"><b>0.4</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../../index.html">Home</a></li>
                <li><a href="../../Downloads.html">Downloads</a></li>
                <li><a href="../../Documentation.html">Documentation</a></li>
                <li><a href="../../Addons.html">Add-ons</a></li>
                <li><a href="../../References.html">References</a></li>
                <li><a href="../../Workshops.html">Workshops</a></li>
                <li><a href="../../Support.html">Support</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../../Downloads.html">Downloads</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Addons.html">Add-ons</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../NewFeatures.html">Version History</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../NewFeatures.html#new-features">New Features</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Documentation.html">Documentation (Python)</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../DocumentationMatlab.html">Documentation (Matlab)</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../References.html">References</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Workshops.html">Workshops</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Workshops.html#sponsored-courses">Sponsored Courses</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Support.html">Support</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Analysis of 2D data (MATLAB)</a><ul>
<li><a class="reference internal" href="#Dataset">Dataset</a><ul>
<li><a class="reference internal" href="#References">References</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Importing-and-visualizing-the-data">Importing and visualizing the data</a></li>
<li><a class="reference internal" href="#Statistical-analysis">Statistical analysis</a></li>
<li><a class="reference internal" href="#Summary">Summary</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><ul>
<li><a class="reference internal" href="#">Analysis of 2D data (MATLAB)</a><ul>
<li><a class="reference internal" href="#Dataset">Dataset</a><ul>
<li><a class="reference internal" href="#References">References</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Importing-and-visualizing-the-data">Importing and visualizing the data</a></li>
<li><a class="reference internal" href="#Statistical-analysis">Statistical analysis</a></li>
<li><a class="reference internal" href="#Summary">Summary</a></li>
</ul>
</li>
</ul>

  <li>
    <a href="ex2d.html" title="Previous Chapter: Analysis of 2D data (Python)"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Analysis of 2...</span>
    </a>
  </li>
  <li>
    <a href="../../Documentation.html" title="Next Chapter: Documentation (Python)"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Documentation... &raquo;</span>
    </a>
  </li>
<form action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
        </div>
      </div>
    <div class="body col-md-12 content" role="main">
      
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<section id="Analysis-of-2D-data-(MATLAB)">
<h1>Analysis of 2D data (MATLAB)<a class="headerlink" href="#Analysis-of-2D-data-(MATLAB)" title="Permalink to this headline">¶</a></h1>
<p>This MATLAB notebook demonstrates how 2D data can be analyzed using <strong>spm1d</strong>.</p>
<div class="alert alert-block alert-info"><p>Note: Currently spm1d can be used only for non-parametric analysis of 2D data.</p>
</div><div class="alert alert-block alert-warning"><p>Warning: 2D data must be registered prior to analysis. spm1d does not support 2D registration. Algorithmic registration of 2D data can be achieved with third-party software like ITK. Manual registration of 2D data is possible with software like 3D Slicer.</p>
</div><div class="alert alert-block alert-warning"><p>Warning: Probability values can not be calculated. Hypothesis testing is possible (i.e., critical test statistic calculation), but spm1d does not support cluster-specific probability calculations for 2D data.</p>
</div><hr class="docutils" />
<section id="Dataset">
<h2>Dataset<a class="headerlink" href="#Dataset" title="Permalink to this headline">¶</a></h2>
<p>The 2D data analyzed below are from <a class="reference external" href="https://www.sciencedirect.com/science/article/pii/S0021929012003193">Pataky (2012)</a>, and include 20 pressure plate measurements of quiet standing in a single subject. Ten measurements were made for each of two quiet standing tasks: backward leaning and forward leaning. For the first ten measurements the subject leaned backward while maintaining toe contact, and for the next ten measurements the subject leaned forward while maintaining heel contact.
Pressure distributions were recorded at 50 Hz for 5 s with a spatial resolution of 8.5 mm.</p>
<p>The attached dataset represents the average 2D pressure distribution (units: kPa) over the 5 s recorded interval. Each of the 20 observations is saved as a (60 x 32) array of pressure values. While the subject was required to step off the measurement plate between each measurement, thus implying non-constant foot positions with respect to the measurement device’s coordinate system, the attached data have been pre-registered following <a class="reference external" href="https://iom3.tandfonline.com/doi/abs/10.1080/10255840903573020">Oliveira et
al. (2010)</a>.</p>
<p>The goal of the analyses below is to test the null hypothes of equal pressure distributions in the two tasks.</p>
<section id="References">
<h3>References<a class="headerlink" href="#References" title="Permalink to this headline">¶</a></h3>
<p>Oliveira FP, Pataky TC, Tavares JM (2010). Registration of pedobarographic image data in the frequency domain. <em>Computer Methods in Biomechanics and Biomedical Engineering</em> 13(6): 731-40.</p>
<p>Pataky TC (2012). Spatial resolution in plantar pressure measurement revisited. <em>Journal of Biomechanics</em> 45(12): 2116-24.</p>
</section>
</section>
<hr class="docutils" />
<section id="Importing-and-visualizing-the-data">
<h2>Importing and visualizing the data<a class="headerlink" href="#Importing-and-visualizing-the-data" title="Permalink to this headline">¶</a></h2>
<p>The data are saved the “data2d” file and can be imported as follows:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-matlab notranslate"><div class="highlight"><pre>
<span></span><span class="nb">load</span><span class="p">(</span><span class="s">&#39;data2d.mat&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;Y&#39;</span><span class="p">)</span><span class="w"></span>

<span class="nb">disp</span><span class="p">(</span><span class="w"> </span><span class="nb">size</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
    20    60    32

</pre></div></div>
</div>
<p>Note that the data are saved in a single 3D array with dimensions (20, 60, 32), implying 20 measurements of (60 x 32) pressure distributions. Individual observations can be visualized like this:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-matlab notranslate"><div class="highlight"><pre>
<span></span><span class="n">I</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">squeeze</span><span class="p">(</span><span class="w"> </span><span class="n">Y</span><span class="p">(</span><span class="mi">1</span><span class="p">,:,:)</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="n">I</span><span class="p">(</span><span class="n">I</span><span class="o">&lt;</span><span class="nb">eps</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">nan</span><span class="p">;</span><span class="w"></span>

<span class="n">h</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">pcolor</span><span class="p">(</span><span class="n">I</span><span class="p">);</span><span class="w"></span>
<span class="nb">set</span><span class="p">(</span><span class="n">h</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;edgecolor&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;none&#39;</span><span class="p">);</span><span class="w"></span>
<span class="nb">colormap</span><span class="p">(</span><span class="w"> </span><span class="nb">jet</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="nb">axis</span><span class="w"> </span><span class="nb">image</span><span class="w"></span>

<span class="n">cbh</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">colorbar</span><span class="p">;</span><span class="w"></span>
<span class="n">cbh</span><span class="p">.</span><span class="n">Label</span><span class="p">.</span><span class="n">String</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&#39;Average pressure (kPa)&#39;</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/doc_Stats2D_ex2d_matlab_5_0.png" src="../../_images/doc_Stats2D_ex2d_matlab_5_0.png" />
</div>
</div>
<p>This represents a single observation of backward leaning. All observations can be visualized as follows.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-matlab notranslate"><div class="highlight"><pre>
<span></span><span class="n">row1</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="p">[];</span><span class="w"></span>
<span class="n">row2</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="p">[];</span><span class="w"></span>
<span class="k">for</span><span class="w"> </span><span class="nb">i</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="mi">10</span><span class="w"></span>
<span class="w">    </span><span class="n">row1</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="n">row1</span><span class="w"> </span><span class="nb">squeeze</span><span class="p">(</span><span class="n">Y</span><span class="p">(</span><span class="nb">i</span><span class="p">,:,:))];</span><span class="w">    </span><span class="c">%#ok&lt;AGROW&gt;</span><span class="w"></span>
<span class="w">    </span><span class="n">row2</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="n">row2</span><span class="w"> </span><span class="nb">squeeze</span><span class="p">(</span><span class="n">Y</span><span class="p">(</span><span class="mi">10</span><span class="o">+</span><span class="nb">i</span><span class="p">,:,:))];</span><span class="w"> </span><span class="c">%#ok&lt;AGROW&gt;</span><span class="w"></span>
<span class="k">end</span><span class="w"></span>
<span class="n">I</span><span class="w">     </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="n">row1</span><span class="p">;</span><span class="w"> </span><span class="n">row2</span><span class="p">];</span><span class="w"></span>

<span class="n">I</span><span class="p">(</span><span class="n">I</span><span class="o">&lt;</span><span class="nb">eps</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">nan</span><span class="p">;</span><span class="w"></span>

<span class="n">h</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">pcolor</span><span class="p">(</span><span class="n">I</span><span class="p">);</span><span class="w"></span>
<span class="nb">colormap</span><span class="p">(</span><span class="w"> </span><span class="nb">jet</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="nb">set</span><span class="p">(</span><span class="n">h</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;edgecolor&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;none&#39;</span><span class="p">);</span><span class="w"></span>
<span class="n">axis</span><span class="w"> </span><span class="s">image</span><span class="w"></span>

<span class="n">cbh</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">colorbar</span><span class="p">;</span><span class="w"></span>
<span class="n">cbh</span><span class="p">.</span><span class="n">Label</span><span class="p">.</span><span class="n">String</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&#39;Average pressure (kPa)&#39;</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/doc_Stats2D_ex2d_matlab_7_0.png" src="../../_images/doc_Stats2D_ex2d_matlab_7_0.png" />
</div>
</div>
<p>The backward and forward leaning trials are depicted in the top and bottom rows, respectively.</p>
<p>The mean distributions for the two tasks can be computed and visualized as follows:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-matlab notranslate"><div class="highlight"><pre>
<span></span><span class="n">mA</span><span class="w">   </span><span class="p">=</span><span class="w"> </span><span class="nb">squeeze</span><span class="p">(</span><span class="w">  </span><span class="nb">mean</span><span class="p">(</span><span class="w"> </span><span class="n">Y</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="mi">10</span><span class="p">,:,:)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w">  </span><span class="p">);</span><span class="w"></span>
<span class="n">mB</span><span class="w">   </span><span class="p">=</span><span class="w"> </span><span class="nb">squeeze</span><span class="p">(</span><span class="w">  </span><span class="nb">mean</span><span class="p">(</span><span class="w"> </span><span class="n">Y</span><span class="p">(</span><span class="mi">11</span><span class="p">:</span><span class="mi">20</span><span class="p">,:,:)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w">  </span><span class="p">);</span><span class="w"></span>
<span class="n">m</span><span class="w">    </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="n">mA</span><span class="w"> </span><span class="n">mB</span><span class="p">];</span><span class="w"></span>
<span class="n">m</span><span class="p">(</span><span class="n">m</span><span class="o">&lt;</span><span class="nb">eps</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">nan</span><span class="p">;</span><span class="w"></span>

<span class="n">h</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">pcolor</span><span class="p">(</span><span class="n">m</span><span class="p">);</span><span class="w"></span>
<span class="nb">colormap</span><span class="p">(</span><span class="w"> </span><span class="nb">jet</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="nb">set</span><span class="p">(</span><span class="n">h</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;edgecolor&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;none&#39;</span><span class="p">);</span><span class="w"></span>
<span class="n">axis</span><span class="w"> </span><span class="s">image</span><span class="w"></span>

<span class="n">cbh</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">colorbar</span><span class="p">;</span><span class="w"></span>
<span class="n">cbh</span><span class="p">.</span><span class="n">Label</span><span class="p">.</span><span class="n">String</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&#39;Average pressure (kPa)&#39;</span><span class="p">;</span><span class="w"></span>
<span class="nb">title</span><span class="p">(</span><span class="s">&#39;Mean pressure distributions&#39;</span><span class="p">)</span><span class="w"></span>
<span class="nb">text</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;Backward leaning&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;horizontalalignment&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;center&#39;</span><span class="p">)</span><span class="w"></span>
<span class="nb">text</span><span class="p">(</span><span class="mi">49</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;Forward leaning&#39;</span><span class="p">,</span><span class="w">  </span><span class="s">&#39;horizontalalignment&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;center&#39;</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/doc_Stats2D_ex2d_matlab_9_0.png" src="../../_images/doc_Stats2D_ex2d_matlab_9_0.png" />
</div>
</div>
</section>
<hr class="docutils" />
<section id="Statistical-analysis">
<h2>Statistical analysis<a class="headerlink" href="#Statistical-analysis" title="Permalink to this headline">¶</a></h2>
<p>A two-sample t test can be conducted on these data using <strong>spm1d</strong> as follows.</p>
<p>The data must be flattened so that each observation is a 1D array.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-matlab notranslate"><div class="highlight"><pre>
<span></span><span class="p">[</span><span class="n">J</span><span class="p">,</span><span class="n">q0</span><span class="p">,</span><span class="n">q1</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">size</span><span class="p">(</span><span class="n">Y</span><span class="p">);</span><span class="w"></span>
<span class="n">Q</span><span class="w">         </span><span class="p">=</span><span class="w"> </span><span class="n">q0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">q1</span><span class="p">;</span><span class="w"></span>
<span class="n">y</span><span class="w">         </span><span class="p">=</span><span class="w"> </span><span class="nb">zeros</span><span class="p">(</span><span class="n">J</span><span class="p">,</span><span class="w"> </span><span class="n">Q</span><span class="p">);</span><span class="w"></span>
<span class="k">for</span><span class="w"> </span><span class="nb">i</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">J</span><span class="w"></span>
<span class="w">    </span><span class="n">y</span><span class="p">(</span><span class="nb">i</span><span class="p">,:)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">reshape</span><span class="p">(</span><span class="w"> </span><span class="n">Y</span><span class="p">(</span><span class="nb">i</span><span class="p">,:,:),</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">[]</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="k">end</span><span class="w"></span>

<span class="nb">disp</span><span class="p">([</span><span class="n">J</span><span class="w"> </span><span class="n">Q</span><span class="p">])</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
          20        1920

</pre></div></div>
</div>
<p>Here J is the number of observations and Q is the number of nodes in the flattened 1D array.</p>
<p>For some types of 2D data, including the pressure distributions above, some nodes can contain zeros for all observations, implying zero variance and thus that test statistic values cannot be computed for these nodes. To avoid this problem it is desireable to remove zero-variance nodes like this:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-matlab notranslate"><div class="highlight"><pre>
<span></span><span class="c">%separate the observations:</span><span class="w"></span>
<span class="n">yA</span><span class="w">        </span><span class="p">=</span><span class="w"> </span><span class="n">y</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="mi">10</span><span class="p">,:,:);</span><span class="w">  </span><span class="c">%flattend observations for Task A</span><span class="w"></span>
<span class="n">yB</span><span class="w">        </span><span class="p">=</span><span class="w"> </span><span class="n">y</span><span class="p">(</span><span class="mi">10</span><span class="p">:</span><span class="mi">20</span><span class="p">,:,:);</span><span class="w">  </span><span class="c">%flattend observations for Task B</span><span class="w"></span>

<span class="c">%find zero-variance nodes:</span><span class="w"></span>
<span class="n">iA</span><span class="w">        </span><span class="p">=</span><span class="w"> </span><span class="nb">std</span><span class="p">(</span><span class="n">yA</span><span class="p">,</span><span class="w"> </span><span class="p">[],</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nb">eps</span><span class="p">;</span><span class="w">  </span><span class="c">%Task A indices where variance &gt; 0</span><span class="w"></span>
<span class="n">iB</span><span class="w">        </span><span class="p">=</span><span class="w"> </span><span class="nb">std</span><span class="p">(</span><span class="n">yB</span><span class="p">,</span><span class="w"> </span><span class="p">[],</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nb">eps</span><span class="p">;</span><span class="w">  </span><span class="c">%Task B indices where variance &gt; 0</span><span class="w"></span>
<span class="nb">i</span><span class="w">         </span><span class="p">=</span><span class="w"> </span><span class="n">iA</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">iB</span><span class="p">;</span><span class="w">               </span><span class="c">%indices where variance &gt; 0 for both tasks</span><span class="w"></span>


<span class="n">ynz</span><span class="w">       </span><span class="p">=</span><span class="w"> </span><span class="n">y</span><span class="p">(:,</span><span class="nb">i</span><span class="p">);</span><span class="w">        </span><span class="c">%all observations with non-zero variance nodes removed</span><span class="w"></span>
<span class="n">ynzA</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n">ynz</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="mi">10</span><span class="p">,:);</span><span class="w">  </span><span class="c">%Task A observations with non-zero variance nodes removed</span><span class="w"></span>
<span class="n">ynzB</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n">ynz</span><span class="p">(</span><span class="mi">11</span><span class="p">:</span><span class="mi">20</span><span class="p">,:);</span><span class="w">  </span><span class="c">%Task B observations with non-zero variance nodes removed</span><span class="w"></span>
</pre></div>
</div>
</div>
<p>Here a two-sample t test will be used. Note that the same procedure can be used for any test in <strong>spm1d.stats.nonparam</strong>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-matlab notranslate"><div class="highlight"><pre>
<span></span><span class="n">snpm</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n">spm1d</span><span class="p">.</span><span class="n">stats</span><span class="p">.</span><span class="n">nonparam</span><span class="p">.</span><span class="n">ttest2</span><span class="p">(</span><span class="n">ynzA</span><span class="p">,</span><span class="w"> </span><span class="n">ynzB</span><span class="p">);</span><span class="w"></span>
<span class="n">snpmi</span><span class="w">     </span><span class="p">=</span><span class="w"> </span><span class="n">snpm</span><span class="p">.</span><span class="n">inference</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;two_tailed&#39;</span><span class="p">,</span><span class="w"> </span><span class="nb">true</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;iterations&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">10000</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<p>That’s it!</p>
<p>Here <code class="docutils literal notranslate"><span class="pre">alpha=0.05</span></code> is the Type I error rate, and <code class="docutils literal notranslate"><span class="pre">iterations=10000</span></code> is the number of iterartions used to build the nonparametric distribution for the test statistic. The number of iterations should be as large as is necessary to achieve numerical stability in the critical threshold, which is indicated below. Here “numerical stability” implies that quantitative changes in the critical test statistic value do not produce qualitative changes in the statistical results. Quantitative changes in
the critical test statistic arise due changes in the number of iterations and/or in the randomization state.</p>
<p>As a rule-of-thumb, at least 1000 iterations are needed, with 10,000 preferred. Also as a rule-of-thumb, run an re-run analyses a number of times to ensure numerical stability.</p>
<p>The <strong>spm1d</strong> results need to be reverted to the original 2D state for visualization. This can be achieved as follows.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-matlab notranslate"><div class="highlight"><pre>
<span></span><span class="n">znz</span><span class="w">       </span><span class="p">=</span><span class="w"> </span><span class="n">snpmi</span><span class="p">.</span><span class="n">z</span><span class="p">;</span><span class="w">     </span><span class="c">%flattened test statistic  (i.e., t value) over only non-zero-variance nodes</span><span class="w"></span>
<span class="n">zstar</span><span class="w">     </span><span class="p">=</span><span class="w"> </span><span class="n">snpmi</span><span class="p">.</span><span class="n">zstar</span><span class="p">;</span><span class="w"> </span><span class="c">%critical test statistic  (i.e., critical t value)</span><span class="w"></span>
<span class="n">z</span><span class="w">         </span><span class="p">=</span><span class="w"> </span><span class="nb">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">Q</span><span class="p">);</span><span class="w">  </span><span class="c">%flattened test statistic including all nodes</span><span class="w"></span>
<span class="n">z</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n">znz</span><span class="p">;</span><span class="w">         </span><span class="c">%add test statistic values for the non-zero-variance nodes</span><span class="w"></span>

<span class="n">Z</span><span class="w">         </span><span class="p">=</span><span class="w"> </span><span class="nb">reshape</span><span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="n">q0</span><span class="w"> </span><span class="n">q1</span><span class="p">]);</span><span class="w">  </span><span class="c">%2D test statistic image</span><span class="w"></span>
<span class="n">Zi</span><span class="w">        </span><span class="p">=</span><span class="w"> </span><span class="n">Z</span><span class="p">;</span><span class="w">                    </span><span class="c">%2D inference image (temporary)</span><span class="w"></span>
<span class="n">Zi</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span><span class="o">&lt;</span><span class="n">zstar</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w">             </span><span class="c">%thresholded test statistic image</span><span class="w"></span>


<span class="n">ZZ</span><span class="w">        </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="n">Z</span><span class="w"> </span><span class="n">Zi</span><span class="p">];</span><span class="w">               </span><span class="c">%both raw test statistic image and inference image</span><span class="w"></span>
<span class="n">ZZ</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span><span class="o">&lt;</span><span class="nb">eps</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">nan</span><span class="p">;</span><span class="w"></span>


<span class="c">%plot:</span><span class="w"></span>
<span class="n">h</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">pcolor</span><span class="p">(</span><span class="n">ZZ</span><span class="p">);</span><span class="w"></span>
<span class="nb">colormap</span><span class="p">(</span><span class="w"> </span><span class="nb">jet</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="nb">caxis</span><span class="p">([</span><span class="o">-</span><span class="mi">15</span><span class="w"> </span><span class="mi">15</span><span class="p">])</span><span class="w"></span>
<span class="nb">set</span><span class="p">(</span><span class="n">h</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;edgecolor&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;none&#39;</span><span class="p">);</span><span class="w"></span>
<span class="n">axis</span><span class="w"> </span><span class="s">image</span><span class="w"></span>

<span class="n">cbh</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">colorbar</span><span class="p">;</span><span class="w"></span>
<span class="n">cbh</span><span class="p">.</span><span class="n">Label</span><span class="p">.</span><span class="n">String</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&#39;t value&#39;</span><span class="p">;</span><span class="w"></span>
<span class="nb">title</span><span class="p">(</span><span class="s">&#39;SPM results&#39;</span><span class="p">)</span><span class="w"></span>
<span class="nb">text</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;Raw SPM&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;horizontalalignment&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;center&#39;</span><span class="p">)</span><span class="w"></span>
<span class="nb">text</span><span class="p">(</span><span class="mi">48</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;Inference&#39;</span><span class="p">,</span><span class="w">  </span><span class="s">&#39;horizontalalignment&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;center&#39;</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/doc_Stats2D_ex2d_matlab_20_0.png" src="../../_images/doc_Stats2D_ex2d_matlab_20_0.png" />
</div>
</div>
<p>The “Raw SPM” image depicts the t values for all non-zero-variance nodes. The “Inference” image is the same, but is thresholded using the critical test statistic. In this case there are nodes whose t values exceed the critical t value, implying that the null hypothesis is rejected.</p>
</section>
<hr class="docutils" />
<section id="Summary">
<h2>Summary<a class="headerlink" href="#Summary" title="Permalink to this headline">¶</a></h2>
<p><strong>spm1d</strong> can be used to conduct nonparametric statistical inference on 2D data, but currently only supports hypothesis testing (i.e., critical test statistic calculation) and does not provide cluster-specific p values. Users requiring cluster-specific values can use another SPM packages like <a class="reference external" href="https://www.fil.ion.ucl.ac.uk/spm/software/spm12/">SPM12</a> or <a class="reference external" href="https://nipy.org">nipy</a>.</p>
</section>
</section>


    </div>
    
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2021, Todd Pataky.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.0.2.<br/>
    </p>
  </div>
</footer>
  </body>
</html>