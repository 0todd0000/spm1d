

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Application &mdash; rft1d 0.2.0 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
  
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  
    <link rel="stylesheet" href="../_static/plot_directive.css" type="text/css" />
  
    <link rel="stylesheet" href="../_static/theme.css" type="text/css" />
  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="rft1d 0.2.0 documentation" href="../index.html"/>
        <link rel="up" title="Examples" href="../Examples.html"/>
        <link rel="next" title="Results from the paper" href="Paper.html"/>
        <link rel="prev" title="Conjugation analysis" href="Validation/Conjugation.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div>
		<!-- <a href="../index.html"><img src="_static/rft1d.png" alt="rft1d.png"</a> -->
		<!-- <img src="_static/rft1d.png" alt="rft1d.png"</img> -->
		<img src="../_static/rft1d.png" alt="rft1d.png"</img>
      </div>


      <div class="wy-side-nav-search">
        <!-- <a href="../index.html" class="fa fa-home"> rft1d</a> -->
		
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        <a href="../index.html" class="fa fa-home"> rft1d</a>
		<!-- <img src="./rft1d.png" alt="rft1d.png"> -->
		
        
            <ul>
<li class="toctree-l1"><a class="reference internal" href="../Download.html">Download</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../Download.html#automated-installation">Automated installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Download.html#source-code-download">Source code download</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Download.html#release-notes">Release Notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Download.html#license-information">License information</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Download.html#license-agreement-for-rft1d">License agreement for rft1d</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Theory.html">RFT Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../Theory.html#gaussian-random-fields">Gaussian random fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Theory.html#expected-field-maximum">Expected field maximum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Theory.html#upcrossings">Upcrossings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Theory.html#expected-upcrossing-geometry">Expected upcrossing geometry</a></li>
</ul>
</li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../Examples.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Basic.html">Basic</a></li>
<li class="toctree-l2"><a class="reference internal" href="BrokenFields.html">Broken fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="Validation.html">Validation</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="Paper.html">Results from the paper</a></li>
<li class="toctree-l2"><a class="reference internal" href="List.html">Scripts (overview)</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../API.html">API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../API/data.html">rft1d.data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../API/distributions.html">rft1d.distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../API/geom.html">rft1d.geom</a></li>
<li class="toctree-l2"><a class="reference internal" href="../API/prob.html">rft1d.prob</a></li>
<li class="toctree-l2"><a class="reference internal" href="../API/random.html">rft1d.random</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../References.html">References</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../References.html#on-the-web">On the web</a></li>
<li class="toctree-l2"><a class="reference internal" href="../References.html#software">Software</a></li>
<li class="toctree-l2"><a class="reference internal" href="../References.html#literature">Literature</a></li>
</ul>
</li>
</ul>

        
		
      </div>
	  
	  
      <!-- <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        <a href="../index.html" class="fa fa-home"> rft1d</a>
      </div> -->
	  
      <!-- <div class="wy-side-nav-search">
        <a href="../index.html" class="fa fa-home"> rft1d</a>
		
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div> -->
	  
	  
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">rft1d</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../Examples.html">Examples</a> &raquo;</li>
      
    <li>Application</li>
      <li class="wy-breadcrumbs-aside">
        
          <!-- <a href="../_sources/Examples/Application.rst.txt" rel="nofollow"> View page source</a> -->
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            
  <section id="application">
<h1>Application<a class="headerlink" href="#application" title="Permalink to this heading">¶</a></h1>
<p>This section describes how RFT can be used to make
statistical inferences regarding sets of smooth 1D
fields.</p>
<section id="example-dataset">
<h2>Example dataset<a class="headerlink" href="#example-dataset" title="Permalink to this heading">¶</a></h2>
<p>Consider the “weather” dataset depicted in the figure below.
This dataset is publicly available at
<a class="reference external" href="http://www.psych.mcgill.ca/misc/fda/downloads/FDAfuns/Matlab">http://www.psych.mcgill.ca/misc/fda/downloads/FDAfuns/Matlab</a>
in the “weather.zip” folder.
The dataset is described in detail here:
<a class="reference external" href="http://www.psych.mcgill.ca/misc/fda/ex-weather-a1.html">http://www.psych.mcgill.ca/misc/fda/ex-weather-a1.html</a>
and also in the book:</p>
<blockquote>
<div><p>Ramsay JO, Silverman BW (2005). <strong>Functional Data Analysis</strong>
(Second Edition), Springer, New York. (see Chapter 13:
“Modelling functional responses with multivariate
covariates”)</p>
</div></blockquote>
<p>These are daily temperature data from four different
regions of Canada. Each field represents the recordings
at one of 35 separate weather stations.</p>
<p>(<a class="reference download internal" download="" href="../_downloads/bd51491ece4c6ad4931b16be0d0fcf25/weather_0_plotdata.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="../_downloads/32ec5aaf8830c9686b3ba02b4cd65545/weather_0_plotdata.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/74a88a178777148321ccd17677890f0a/weather_0_plotdata.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/fa81fcaa3827780222c6a251bc349043/weather_0_plotdata.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../_images/weather_0_plotdata.png" class="plot-directive" src="../_images/weather_0_plotdata.png" />
</figure>
</section>
<section id="parametric-inference-using-rft">
<h2>Parametric inference using RFT<a class="headerlink" href="#parametric-inference-using-rft" title="Permalink to this heading">¶</a></h2>
<p>For simplicity’s let’s consider just two regions: Atlantic and
Continental (the regions with the most observations: 15 and 12,
respectively). If the data for these two regions are stored in variables
“<em>yA</em>” and “<em>yB</em>”, respectively, where each variable is a
NumPy array with shape (nResponses, 365), then then the two-sample
t statistic field computed as follows:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nA</span><span class="p">,</span><span class="n">nB</span> <span class="o">=</span> <span class="mi">15</span><span class="p">,</span><span class="mi">12</span>  <span class="c1">#sample sizes</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mA</span><span class="p">,</span><span class="n">mB</span> <span class="o">=</span> <span class="n">yA</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">yB</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>  <span class="c1">#means</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sA</span><span class="p">,</span><span class="n">sB</span> <span class="o">=</span> <span class="n">yA</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">yB</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>  <span class="c1">#standard deviations</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span> <span class="p">((</span><span class="n">nA</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sA</span><span class="o">*</span><span class="n">sA</span> <span class="o">+</span> <span class="p">(</span><span class="n">nB</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sB</span><span class="o">*</span><span class="n">sB</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">nA</span> <span class="o">+</span> <span class="n">nB</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="p">)</span>  <span class="c1">#pooled standard deviation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">mA</span><span class="o">-</span><span class="n">mB</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span> <span class="n">s</span> <span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="n">nA</span> <span class="o">+</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">nB</span><span class="p">))</span>  <span class="c1">#t field</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For simplicity this t field calculation assumes equal variance, but field-level non-spherecity corrections exist <a class="reference internal" href="../References.html#label-rftliterature"><span class="std std-ref">(Friston et al. 2007)</span></a>.</p>
</div>
<p>The resulting t field (depicted in the figure below) suggests
that temperature differences between the Atlantic and Continental
regions are largest in the winter months, reflecting the same trend
in the raw fields (above).</p>
<p>(<a class="reference download internal" download="" href="../_downloads/aa7732c5c2bd46c6413be334267d178a/weather_1_rft_field_only.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="../_downloads/c6c716f9135fd0ba02659c513287bbfc/weather_1_rft_field_only.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/afa2c5e431d486110c2db25b8c44ec28/weather_1_rft_field_only.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/63d2d7475d35959f09e253e318fccb5c/weather_1_rft_field_only.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../_images/weather_1_rft_field_only.png" class="plot-directive" src="../_images/weather_1_rft_field_only.png" />
</figure>
<p>From a classical hypothesis testing perspective the relevant question is this:</p>
<blockquote>
<div><p>What height would Gaussian fields (with the same FWHM as the model residuals)
reach with a probability of <img class="math" src="../_images/math/2f5aa019312e1bbc969deab8dca8b00f76025404.png" alt="\alpha"/> ?</p>
</div></blockquote>
<p>To answer that question we need to first compute the model residuals, in
this case by simply subtracting field means from the original fields:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">residualsA</span><span class="p">,</span><span class="n">residualsB</span> <span class="o">=</span> <span class="n">yA</span><span class="o">-</span><span class="n">mA</span><span class="p">,</span> <span class="n">yB</span><span class="o">-</span><span class="n">mB</span>  <span class="c1">#residual fields</span>
</pre></div>
</div>
<p>These residuals may be regarded as Gaussian random fields, and they look like this:</p>
<p>(<a class="reference download internal" download="" href="../_downloads/8e0c6cf969b46cfab78bb656ea652283/weather_1_rft_residuals.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="../_downloads/2f6f769e8e997fc0b2666741da1b38fd/weather_1_rft_residuals.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/b23bcc48dc8f244eaf367b03d2ad10f2/weather_1_rft_residuals.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/d66b898ae8ee137bc5654f1b21c6e7a6/weather_1_rft_residuals.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../_images/weather_1_rft_residuals.png" class="plot-directive" src="../_images/weather_1_rft_residuals.png" />
</figure>
<p>Next we estimate the field smoothness using all residuals as follows:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">residuals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">rA</span><span class="p">,</span><span class="n">rB</span><span class="p">])</span> <span class="c1">#all residual fields; shape=(27,365)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FWHM</span> <span class="o">=</span> <span class="n">rft1d</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">estimate_fwhm</span><span class="p">(</span><span class="n">residuals</span><span class="p">)</span> <span class="c1">#yields #135.7</span>
</pre></div>
</div>
<p>Since we know the FWHM (135.7) and we know the field length (365 nodes),
we have all the parameters we need to conduct parametric inference:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">nA</span> <span class="o">+</span> <span class="n">nB</span> <span class="o">-</span> <span class="mi">2</span>  <span class="c1">#degrees of freedom</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nNodes</span> <span class="o">=</span> <span class="mi">365</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tstar</span> <span class="o">=</span> <span class="n">rft1d</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">isf</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">nNodes</span><span class="p">,</span> <span class="n">FWHM</span><span class="p">)</span> <span class="c1">#inverse survival function</span>
</pre></div>
</div>
<p>This yields a critical threhsold of 2.566, as depicted in the figure
below. Since the test statistic field exceeds the critical threshold
we would reject the null hypothesis at <img class="math" src="../_images/math/2f5aa019312e1bbc969deab8dca8b00f76025404.png" alt="\alpha"/> = 0.05.</p>
<p>To supplement the main null hypothesis rejection, we can next conduct set-level
and cluster-level inference. For both we need the upcrossing extents:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">calc</span> <span class="o">=</span> <span class="n">rft1d</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">ClusterMetricCalculator</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">k_nodes</span> <span class="o">=</span> <span class="n">calc</span><span class="o">.</span><span class="n">cluster_extents</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">tstar</span><span class="p">,</span> <span class="n">interp</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">k_resels</span> <span class="o">=</span> <span class="p">[</span><span class="n">kk</span><span class="o">/</span><span class="n">FWHM</span> <span class="k">for</span> <span class="n">kk</span> <span class="ow">in</span> <span class="n">k_nodes</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="c1">#number of upcrossings</span>
</pre></div>
</div>
<p>Set-level inference requires <em>c</em> and the smallest value from <em>k_resels</em>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rftcalc</span> <span class="o">=</span> <span class="n">rft1d</span><span class="o">.</span><span class="n">prob</span><span class="o">.</span><span class="n">RFTCalculator</span><span class="p">(</span><span class="n">STAT</span><span class="o">=</span><span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">df</span><span class="p">),</span> <span class="n">nodes</span><span class="o">=</span><span class="n">nNodes</span><span class="p">,</span> <span class="n">FWHM</span><span class="o">=</span><span class="n">FWHM</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">k_min</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">k_resels</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Pset</span> <span class="o">=</span> <span class="n">rftcalc</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">k_min</span><span class="p">,</span> <span class="n">tstar</span><span class="p">)</span>
</pre></div>
</div>
<p>The resulting p value (8.244e-05) represents the probability that Gaussian
fields would produce at least <em>c</em> upcrossings with a minimum extent of <em>k_min</em>
when thresholded at <em>tstar</em>. Since this probability pertains to the entire
excursion set, and thus in this case to the whole year, we cannot use this result
to make conclusion about particular parts of the year. For that we can use
cluster-level inference:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Pcluster</span> <span class="o">=</span> <span class="p">[</span><span class="n">rftcalc</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">cluster</span><span class="p">(</span><span class="n">kk</span><span class="p">,</span> <span class="n">tstar</span><span class="p">)</span>   <span class="k">for</span> <span class="n">kk</span> <span class="ow">in</span> <span class="n">k_resels</span><span class="p">]</span>
</pre></div>
</div>
<p>This yields the p values depicted in the figure below (0.013 and 0.002).
These represent the probability that Gaussian fields would produce an
upcrossing of extent <em>kk</em> when thresholded at <em>tstar</em>.</p>
<p>(<a class="reference download internal" download="" href="../_downloads/e1755115109acc4a65541f693e052a97/weather_1_rft.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="../_downloads/d93845443b27ae924b4ad2af4ecf259f/weather_1_rft.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/f071e4cb3215811e6da567b1c53b7c6a/weather_1_rft.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/80771337af0dbaa663a274bab28696c4/weather_1_rft.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../_images/weather_1_rft.png" class="plot-directive" src="../_images/weather_1_rft.png" />
</figure>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If an upcrossing just touches the critical threshold, its p value is <img class="math" src="../_images/math/2f5aa019312e1bbc969deab8dca8b00f76025404.png" alt="\alpha"/> (by defintion).</p>
</div>
<p>A non-parametric approach <a class="reference internal" href="#label-application-nonparametric"><span class="std std-ref">described below</span></a>
yields nearly identical results, suggesting that the parametric approach’s
assumption of Gaussian field variance is a reasonably good one.</p>
<p>Note that the results above separate the upcrossings which touch
the field border. It is probably more appropriate to regard the field
as circular (since the first day of the new year follows the
last day of the previous year), and thus to regard the upcrossings as
connected. This can be achieved easily using the keyword <em>wrap</em> to
<strong>rft1d</strong> procedures
<a class="reference internal" href="#label-application-fieldwrapping"><span class="std std-ref">as described below</span></a></p>
</section>
<section id="non-parametric-inference">
<span id="label-application-nonparametric"></span><h2>Non-parametric inference<a class="headerlink" href="#non-parametric-inference" title="Permalink to this heading">¶</a></h2>
<p>A conceptually identical non-parametric permutation approach has been described by
<a class="reference internal" href="../References.html#label-rftliterature"><span class="std std-ref">Nichols and Holmes (2002)</span></a>.
It proceeds the same as typical permutation tests, with the minor exception
that it constructs separate empirical distributions: one for the field maximum,
and following that: one for upcrossings. The approach can be summarized as
follows:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Randomly permute the labels</p></li>
<li><p>Compute the test statistic field based on the new labels.</p></li>
<li><p>Extract the field maximum (<em>z_max</em>).</p></li>
<li><p>Repeat (1)–(3) until all permutations have been exhausted or until the <em>z_max</em> distribution is reasonably stable.</p></li>
<li><p>Extract the critical test statistic (<em>z_star</em>) from the <em>z_max</em> distribution.</p></li>
<li><p>Repeat (1)–(4), this time extracting the maximum upcrossing extent (<em>k_max</em>) at threshold <em>z_star</em> for each permutation.</p></li>
<li><p>Compute upcrossing-specific p values based on the empirical <em>k_max</em> distribution.</p></li>
</ol>
</div></blockquote>
<p>The results are depicted in the figure below. The non-parametric critical
threshold (2.359) is somewhat lower than the parametric threshold (2.566),
but the upcrossing p values are essentially identical. Click on “source code”
below to see coding details.</p>
<p>(<a class="reference download internal" download="" href="../_downloads/589a2aea7c9f9919296fd6f69928901b/weather_2_nonparam.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="../_downloads/8229f6ef8d54f17d880246460004ead6/weather_2_nonparam.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/bca168853762b35258445e0a59bdbdcb/weather_2_nonparam.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/810c571618458f45a103a6ef6adf3fc5/weather_2_nonparam.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../_images/weather_2_nonparam.png" class="plot-directive" src="../_images/weather_2_nonparam.png" />
</figure>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The non-parametric approach of offers a number of other advantages, such as estimated variance field smoothing, which can improve statistical power (<a class="reference internal" href="../References.html#label-rftliterature"><span class="std std-ref">(Nichols and Holmes, 2002)</span></a>). The purpose here was to demonstrate only that, like the 0D case, complimentary non-parametric approaches also exist for the 1D case.</p>
</div>
</section>
<section id="field-wrapping">
<span id="label-application-fieldwrapping"></span><h2>Field wrapping<a class="headerlink" href="#field-wrapping" title="Permalink to this heading">¶</a></h2>
<p>Since this dataset is cyclical (i.e. after 31 December comes 1 Jan)
inference is more appropriately conducted by wrapping the upcrossing
as indicated in the figure below. Notice that there is just one p
value, corresponding to the single (wrapped) upcrossing. Its p value
is much lower because its extent is much greater.</p>
<p>(<a class="reference download internal" download="" href="../_downloads/a9107ef34b5c1b8120048908bb70aada/weather_3_wrapped.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="../_downloads/c409f2bcc338e2755d3920d9637b42ad/weather_3_wrapped.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/d1996eae90ca76a6d660b393b9c434c6/weather_3_wrapped.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/d8c4098aa52dd63f968209975e637a59/weather_3_wrapped.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../_images/weather_3_wrapped.png" class="plot-directive" src="../_images/weather_3_wrapped.png" />
</figure>
</section>
</section>


          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="Validation/Conjugation.html" class="btn btn-neutral float-left" title="Conjugation analysis" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="Paper.html" class="btn btn-neutral float-right" title="Results from the paper" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Todd Pataky.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>

    </section>

  </div>
  

  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.2.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/documentation_options.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/sphinx_highlight.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>


