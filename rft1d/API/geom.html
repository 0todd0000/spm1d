

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>rft1d.geom &mdash; rft1d 0.2.0 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
  
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  
    <link rel="stylesheet" href="../_static/plot_directive.css" type="text/css" />
  
    <link rel="stylesheet" href="../_static/theme.css" type="text/css" />
  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="rft1d 0.2.0 documentation" href="../index.html"/>
        <link rel="up" title="API" href="../API.html"/>
        <link rel="next" title="rft1d.prob" href="prob.html"/>
        <link rel="prev" title="rft1d.distributions" href="distributions.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div>
		<!-- <a href="../index.html"><img src="_static/rft1d.png" alt="rft1d.png"</a> -->
		<!-- <img src="_static/rft1d.png" alt="rft1d.png"</img> -->
		<img src="../_static/rft1d.png" alt="rft1d.png"</img>
      </div>


      <div class="wy-side-nav-search">
        <!-- <a href="../index.html" class="fa fa-home"> rft1d</a> -->
		
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        <a href="../index.html" class="fa fa-home"> rft1d</a>
		<!-- <img src="./rft1d.png" alt="rft1d.png"> -->
		
        
            <ul>
<li class="toctree-l1"><a class="reference internal" href="../Download.html">Download</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../Download.html#automated-installation">Automated installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Download.html#source-code-download">Source code download</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Download.html#release-notes">Release Notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Download.html#license-information">License information</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Download.html#license-agreement-for-rft1d">License agreement for rft1d</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Theory.html">RFT Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../Theory.html#gaussian-random-fields">Gaussian random fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Theory.html#expected-field-maximum">Expected field maximum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Theory.html#upcrossings">Upcrossings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Theory.html#expected-upcrossing-geometry">Expected upcrossing geometry</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Examples.html">Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../Examples/Basic.html">Basic</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Examples/BrokenFields.html">Broken fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Examples/Validation.html">Validation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Examples/Application.html">Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Examples/Paper.html">Results from the paper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Examples/List.html">Scripts (overview)</a></li>
</ul>
</li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../API.html">API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="data.html">rft1d.data</a></li>
<li class="toctree-l2"><a class="reference internal" href="distributions.html">rft1d.distributions</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">rft1d.geom</a></li>
<li class="toctree-l2"><a class="reference internal" href="prob.html">rft1d.prob</a></li>
<li class="toctree-l2"><a class="reference internal" href="random.html">rft1d.random</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../References.html">References</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../References.html#on-the-web">On the web</a></li>
<li class="toctree-l2"><a class="reference internal" href="../References.html#software">Software</a></li>
<li class="toctree-l2"><a class="reference internal" href="../References.html#literature">Literature</a></li>
</ul>
</li>
</ul>

        
		
      </div>
	  
	  
      <!-- <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        <a href="../index.html" class="fa fa-home"> rft1d</a>
      </div> -->
	  
      <!-- <div class="wy-side-nav-search">
        <a href="../index.html" class="fa fa-home"> rft1d</a>
		
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div> -->
	  
	  
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">rft1d</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../API.html">API</a> &raquo;</li>
      
    <li>rft1d.geom</li>
      <li class="wy-breadcrumbs-aside">
        
          <!-- <a href="../_sources/API/geom.rst.txt" rel="nofollow"> View page source</a> -->
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            
  <section id="module-rft1d.geom">
<span id="rft1d-geom"></span><span id="label-api-geom"></span><h1>rft1d.geom<a class="headerlink" href="#module-rft1d.geom" title="Permalink to this heading">¶</a></h1>
<p>Geometry module</p>
<p>This module contains functions for computing various geomtric characteristics
of 1D fields and upcrossings.</p>
<section id="basic-geometry-functions">
<h2>Basic geometry functions:<a class="headerlink" href="#basic-geometry-functions" title="Permalink to this heading">¶</a></h2>
<section id="bwlabel">
<h3>bwlabel<a class="headerlink" href="#bwlabel" title="Permalink to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="rft1d.geom.bwlabel">
<span class="sig-prename descclassname"><span class="pre">rft1d.geom.</span></span><span class="sig-name descname"><span class="pre">bwlabel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">merge_wrapped</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rft1d.geom.bwlabel" title="Permalink to this definition">¶</a></dt>
<dd><p>Label clusters in a binary field <em>b</em>.
This function yields the same output as <strong>scipy.ndimage.measurements.label</strong>
but is much faster for 1D fields.
If <em>merge_wrapped</em></p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><em>b</em> — a binary field</p>
<p><em>merge_wrapped</em> — if True, boundary upcrossings will be merged into a single cluster.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>L</em> — labeled upcrossings (array of integers)</p>
<p><em>n</em> — number of upcrossings</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">rft1d</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn1d</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">y</span> <span class="o">&gt;</span> <span class="mf">2.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">L</span><span class="p">,</span><span class="n">n</span> <span class="o">=</span> <span class="n">rft1d</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">bwlabel</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

</section>
<section id="estimate-fwhm">
<h3>estimate_fwhm<a class="headerlink" href="#estimate-fwhm" title="Permalink to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="rft1d.geom.estimate_fwhm">
<span class="sig-prename descclassname"><span class="pre">rft1d.geom.</span></span><span class="sig-name descname"><span class="pre">estimate_fwhm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">R</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rft1d.geom.estimate_fwhm" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimate field smoothness (FWHM) from a set of random fields or a set of residuals.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><em>R</em> — a set of random fields, or a set of residuals</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>FWHM</em> — the estimated FWHM</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">FWHM</span> <span class="o">=</span> <span class="mf">12.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">rft1d</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn1d</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="n">FWHM</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span> <span class="o">=</span> <span class="n">rft1d</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">estimate_fwhm</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="c1">#should be close to 12.5</span>
</pre></div>
</div>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The estimated FWHM will differ from the specified FWHM (just like sample means differ from the population mean). This function implements an unbiased estimate of the FWHM, so the average of many FWHM estimates is expected to converge to the specified value.</p>
</div>
</dd></dl>

</section>
</section>
<hr class="docutils" />
<section id="field-geometry-resel-counts">
<h2>Field geometry (resel counts)<a class="headerlink" href="#field-geometry-resel-counts" title="Permalink to this heading">¶</a></h2>
<section id="resel-counts">
<h3>resel_counts<a class="headerlink" href="#resel-counts" title="Permalink to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="rft1d.geom.resel_counts">
<span class="sig-prename descclassname"><span class="pre">rft1d.geom.</span></span><span class="sig-name descname"><span class="pre">resel_counts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">R</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fwhm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">element_based</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rft1d.geom.resel_counts" title="Permalink to this definition">¶</a></dt>
<dd><p>Resolution element (resel) counts.</p>
<p>This function assembles resel counts, either from a set of residuals or
from a binary mask. If using a binary mask, True represents regions which
are masked out.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><em>R</em> — a set of random fields, a set of residuals, or a binary field mask</p>
<p><em>fwhm</em> — the true or estimated FWHM</p>
<p><em>element_based</em> — element-based sampling (default: node-based sampling)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>resels</em> — (<em>r0</em>, <em>r1</em>):  0D and 1D resel counts, respectively</p>
</dd>
<dt class="field-odd">Note</dt>
<dd class="field-odd"><p>The resel counts define the field on which the random process occurs.
The first count (<em>r0</em>) is the Hadwiger characteristic, which specifies
the number of unbroken field segments. An unbroken field has <em>r0</em> = 1.
The second count (<em>r1</em>) is the field size divided by the FWHM.</p>
</dd>
<dt class="field-even">Important</dt>
<dd class="field-even"><p>All RFT expectations stem directly from these resel counts.</p>
</dd>
<dt class="field-odd">Important cases</dt>
<dd class="field-odd"><ol class="arabic simple">
<li><p>Node-based sampling (default), unbroken field with Q nodes — the field size is (Q-1) and <strong>resels = [1, (Q-1)/FWHM]</strong></p></li>
<li><p>Element-based sampling, unbroken field, Q elements — the field size is Q and <strong>resels = [1, Q/FWHM]</strong></p></li>
<li><p>Node-based sampling (default), broken field with S segements and Q nodes — the field size is (Q-S) and <strong>resels = [S, (Q-S)/FWHM]</strong></p></li>
<li><p>Element-based sampling, broken field with S segements and Q elements — the field size is Q and <strong>resels = [S, Q/FWHM]</strong></p></li>
</ol>
</dd>
<dt class="field-even">Examples (unbroken field)</dt>
<dd class="field-even"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">101</span><span class="p">)</span> <span class="c1">#no masked regions</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">resels</span> <span class="o">=</span> <span class="n">rft1d</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">resel_counts</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">fwhm</span><span class="o">=</span><span class="mf">10.0</span><span class="p">)</span> <span class="c1">#yields(1,10)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">resels</span> <span class="o">=</span> <span class="n">rft1d</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">resel_counts</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">fwhm</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">element_based</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1">#yields(1,10.1)</span>
</pre></div>
</div>
</dd>
<dt class="field-odd">Examples (broken field)</dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">101</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="p">[</span><span class="mi">25</span><span class="p">:</span><span class="mi">55</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">resels</span> <span class="o">=</span> <span class="n">rft1d</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">resel_counts</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">fwhm</span><span class="o">=</span><span class="mf">10.0</span><span class="p">)</span> <span class="c1">#yields(2,6.9)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">resels</span> <span class="o">=</span> <span class="n">rft1d</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">resel_counts</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">fwhm</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">element_based</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1">#yields(2,7.1)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

</section>
<hr class="docutils" />
<section id="resel-conversion-functions">
<h3>resel conversion functions<a class="headerlink" href="#resel-conversion-functions" title="Permalink to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="rft1d.geom.resels2fwhm">
<span class="sig-prename descclassname"><span class="pre">rft1d.geom.</span></span><span class="sig-name descname"><span class="pre">resels2fwhm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">resels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nNodes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">element_based</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rft1d.geom.resels2fwhm" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the FWHM from resel counts based on the number of field nodes.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><em>resels</em> — resel counts</p>
<p><em>nNodes</em> — number of field nodes (in broken fields: number of unbroken nodes)</p>
<p><em>element_based</em> — element-based sampling (default: node-based sampling)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>fwhm</em> — field FWHM</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">resels</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span> <span class="o">=</span> <span class="n">rft1d</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">resels2fwhm</span><span class="p">(</span><span class="n">resels</span><span class="p">,</span> <span class="mi">101</span><span class="p">)</span> <span class="c1">#yields 10.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">resels</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mf">6.9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span> <span class="o">=</span> <span class="n">rft1d</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">resels2fwhm</span><span class="p">(</span><span class="n">resels</span><span class="p">,</span> <span class="mi">71</span><span class="p">)</span> <span class="c1">#yields 10.0</span>
</pre></div>
</div>
</dd>
<dt class="field-even">Note</dt>
<dd class="field-even"><p>See <strong>rft1d.geom.resel_counts</strong> for details regarding the keyword “element_based”** and node-based vs. element-based sampling.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="rft1d.geom.resels2fwhm_masked">
<span class="sig-prename descclassname"><span class="pre">rft1d.geom.</span></span><span class="sig-name descname"><span class="pre">resels2fwhm_masked</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">resels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">element_based</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rft1d.geom.resels2fwhm_masked" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the FWHM from resel counts based on a binary field mask</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><em>resels</em> — resel counts</p>
<p><em>mask</em> — binary field mask</p>
<p><em>element_based</em> — element-based sampling (default: node-based sampling)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>fwhm</em> — field FWHM</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">resels</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mf">6.9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">101</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="p">[</span><span class="mi">25</span><span class="p">:</span><span class="mi">55</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span> <span class="o">=</span> <span class="n">rft1d</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">resels2fwhm_masked</span><span class="p">(</span><span class="n">resels</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="c1">#yields 10.0</span>
</pre></div>
</div>
</dd>
<dt class="field-even">Note</dt>
<dd class="field-even"><p>See <strong>rft1d.geom.resel_counts</strong> for details regarding the keyword “element_based”** and node-based vs. element-based sampling.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="rft1d.geom.resels2nelements">
<span class="sig-prename descclassname"><span class="pre">rft1d.geom.</span></span><span class="sig-name descname"><span class="pre">resels2nelements</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">resels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fwhm</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rft1d.geom.resels2nelements" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the field size from resel counts based on the FWHM (element-based sampling).</p>
<dl class="field-list">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">resels</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nNodes</span> <span class="o">=</span> <span class="n">rft1d</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">resels2nelements</span><span class="p">(</span><span class="n">resels</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">)</span> <span class="c1">#yields 100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">resels</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mf">6.9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nNodes</span> <span class="o">=</span> <span class="n">rft1d</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">resels2nelements</span><span class="p">(</span><span class="n">resels</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">)</span> <span class="c1">#yields 69</span>
</pre></div>
</div>
</dd>
<dt class="field-even">Note</dt>
<dd class="field-even"><p>See <strong>rft1d.geom.resel_counts</strong> for details regarding node-based vs. element-based sampling.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="rft1d.geom.resels2nnodes">
<span class="sig-prename descclassname"><span class="pre">rft1d.geom.</span></span><span class="sig-name descname"><span class="pre">resels2nnodes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">resels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fwhm</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rft1d.geom.resels2nnodes" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of field nodes from resel counts based on the FWHM</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><em>resels</em> — resel counts</p>
<p><em>fwhm</em> — actual or estimated FWHM*element_based* — element-based sampling (default: node-based sampling)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>nNodes</em> — number of field nodes</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">resels</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nNodes</span> <span class="o">=</span> <span class="n">rft1d</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">resels2nnodes</span><span class="p">(</span><span class="n">resels</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">)</span> <span class="c1">#yields 101</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">resels</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mf">6.9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nNodes</span> <span class="o">=</span> <span class="n">rft1d</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">resels2nnodes</span><span class="p">(</span><span class="n">resels</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">)</span> <span class="c1">#yields 71</span>
</pre></div>
</div>
</dd>
<dt class="field-even">Note</dt>
<dd class="field-even"><p>See <strong>rft1d.geom.resel_counts</strong> for details regarding node-based vs. element-based sampling.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="rft1d.geom.resels2fieldsize">
<span class="sig-prename descclassname"><span class="pre">rft1d.geom.</span></span><span class="sig-name descname"><span class="pre">resels2fieldsize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">resels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fwhm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">element_based</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rft1d.geom.resels2fieldsize" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the field size from resel counts based on the FWHM.
Equivalent to <strong>rft1d.geom.resels2nnodes</strong> minus the number of unbroken
field segments.</p>
<dl class="field-list">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">resels</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nNodes</span> <span class="o">=</span> <span class="n">rft1d</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">resels2fieldsize</span><span class="p">(</span><span class="n">resels</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">)</span> <span class="c1">#yields 100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">resels</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mf">6.9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nNodes</span> <span class="o">=</span> <span class="n">rft1d</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">resels2fieldsize</span><span class="p">(</span><span class="n">resels</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">)</span> <span class="c1">#yields 69</span>
</pre></div>
</div>
</dd>
<dt class="field-even">Note</dt>
<dd class="field-even"><p>See <strong>rft1d.geom.resel_counts</strong> for details regarding the keyword “element_based”** and node-based vs. element-based sampling.</p>
</dd>
</dl>
</dd></dl>

</section>
</section>
<hr class="docutils" />
<section id="upcrossing-metric-calculations">
<h2>Upcrossing metric calculations<a class="headerlink" href="#upcrossing-metric-calculations" title="Permalink to this heading">¶</a></h2>
<section id="rft1d-geom-clustermetriccalculator">
<h3>rft1d.geom.ClusterMetricCalculator<a class="headerlink" href="#rft1d-geom-clustermetriccalculator" title="Permalink to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="rft1d.geom.ClusterMetricCalculator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">rft1d.geom.</span></span><span class="sig-name descname"><span class="pre">ClusterMetricCalculator</span></span><a class="headerlink" href="#rft1d.geom.ClusterMetricCalculator" title="Permalink to this definition">¶</a></dt>
<dd><p>A class for computing various geometric characteristics of the excursion set
including number of upcrossings, upcrossing (cluster) extents, etc.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><em>None</em></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>calc</em> — a ClusterMetricCalculator instance</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">rft1d</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn1d</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mf">15.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">calc</span> <span class="o">=</span> <span class="n">rft1d</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">ClusterMetricCalculator</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">k</span> <span class="o">=</span> <span class="n">calc</span><span class="o">.</span><span class="n">cluster_extents</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span> <span class="c1">#cluster extents when thresholded at 0.5</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="rft1d.geom.ClusterMetricCalculator.cluster_extents">
<span class="sig-name descname"><span class="pre">cluster_extents</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wrap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rft1d.geom.ClusterMetricCalculator.cluster_extents" title="Permalink to this definition">¶</a></dt>
<dd><p>Upcrossing extents (units: nodes).</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><em>y</em> — a 1D field</p>
<p><em>u</em> — threshold height</p>
<p><em>interp</em> — interpolate to threshold <em>u</em></p>
<p><em>wrap</em> — wrap upcrossings from the end to the start of the field</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>k</em> — list of upcrossing extents, or [0] if no upcrossings</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">k</span> <span class="o">=</span> <span class="n">calc</span><span class="o">.</span><span class="n">cluster_extents</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span> <span class="c1">#cluster extents when thresholded at 0.0</span>
</pre></div>
</div>
</dd>
</dl>
<div class="admonition danger">
<p class="admonition-title">Danger</p>
<p>Setting <em>interp</em> to False is faster, but it will cause disagreements between node-based and element-based sampling. If the upcrossing is large this difference is negligible, but for small upcrossing there may be strange results (e.g. upcrossing with an extent of zero). Recommendation: <strong>always interpolate</strong>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rft1d.geom.ClusterMetricCalculator.cluster_minima">
<span class="sig-name descname"><span class="pre">cluster_minima</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rft1d.geom.ClusterMetricCalculator.cluster_minima" title="Permalink to this definition">¶</a></dt>
<dd><p>Minimum field height inside each upcrossing.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><em>y</em> — a 1D field</p>
<p><em>u</em> — threshold height</p>
<p><em>interp</em> — interpolate to threshold <em>u</em></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>zmin</em> — list of upcrossing minima; [0] if no upcrossings</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">k</span> <span class="o">=</span> <span class="n">calc</span><span class="o">.</span><span class="n">cluster_minima</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If <em>interp</em> is <em>True</em>, the minima are all <em>u</em>.</p>
</div>
<div class="admonition danger">
<p class="admonition-title">Danger</p>
<p>If <em>u</em> is zero and <em>interp</em> is <em>True</em> the user may be unable to distinguish between two cases: (i) no upcrossings and (ii) one upcrossing with a minimum of zero. Most thresholds we’re interested in are much higher than zero, so this buggy behavior is not deemed serious. To check the number of upcrossings use the <strong>nMaxima</strong> method.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rft1d.geom.ClusterMetricCalculator.max_cluster_extent">
<span class="sig-name descname"><span class="pre">max_cluster_extent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wrap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rft1d.geom.ClusterMetricCalculator.max_cluster_extent" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximum upcrossing extent</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><em>y</em> — a 1D field</p>
<p><em>u</em> — threshold height</p>
<p><em>interp</em> — interpolate to threshold <em>u</em></p>
<p><em>wrap</em> — wrap upcrossings from the end to the start of the field</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>kmax</em> — maximum upcrossing extent (unit: nodes)</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">k</span> <span class="o">=</span> <span class="n">calc</span><span class="o">.</span><span class="n">max_cluster_extent</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<div class="admonition danger">
<p class="admonition-title">Danger</p>
<p>Setting <em>interp</em> to False is faster, but it will cause disagreements between node-based and element-based sampling. If the upcrossing is large this difference is negligible, but for small upcrossing there may be strange results (e.g. upcrossing with an extent of zero). Recommendation: <strong>always interpolate</strong>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rft1d.geom.ClusterMetricCalculator.mean_cluster_extent">
<span class="sig-name descname"><span class="pre">mean_cluster_extent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wrap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rft1d.geom.ClusterMetricCalculator.mean_cluster_extent" title="Permalink to this definition">¶</a></dt>
<dd><p>Mean upcrossing extent</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><em>y</em> — a 1D field</p>
<p><em>u</em> — threshold height</p>
<p><em>interp</em> — interpolate to threshold <em>u</em></p>
<p><em>wrap</em> — wrap upcrossings from the end to the start of the field</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>kmean</em> — mean upcrossing extent (unit: nodes)</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">k</span> <span class="o">=</span> <span class="n">calc</span><span class="o">.</span><span class="n">mean_cluster_extent</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<div class="admonition danger">
<p class="admonition-title">Danger</p>
<p>Setting <em>interp</em> to False is faster, but it will cause disagreements between node-based and element-based sampling. If the upcrossing is large this difference is negligible, but for small upcrossing there may be strange results (e.g. upcrossing with an extent of zero). Recommendation: <strong>always interpolate</strong>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rft1d.geom.ClusterMetricCalculator.nMaxima">
<span class="sig-name descname"><span class="pre">nMaxima</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rft1d.geom.ClusterMetricCalculator.nMaxima" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of maxima. Equivalent to <strong>nUpcrossings</strong>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rft1d.geom.ClusterMetricCalculator.nSuprathresholdNodes">
<span class="sig-name descname"><span class="pre">nSuprathresholdNodes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rft1d.geom.ClusterMetricCalculator.nSuprathresholdNodes" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of nodes in the excursion set.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><em>y</em> — a 1D field</p>
<p><em>u</em> — threshold height</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>nNodes</em> — number of nodes which survive the threshold <em>u</em></p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nNodes</span> <span class="o">=</span> <span class="n">calc</span><span class="o">.</span><span class="n">nSuprathresholdNodes</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This returns simply the number of nodes, which is not equivelent to extent. To compute the total extent you must subtract the number of upcrossings from this value. Otherwise use <strong>rft1d.geom.nSuprathresholdResels</strong> or <strong>rft1d.geom.total_excursion_set_extent</strong>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rft1d.geom.ClusterMetricCalculator.nSuprathresholdResels">
<span class="sig-name descname"><span class="pre">nSuprathresholdResels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fwhm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rft1d.geom.ClusterMetricCalculator.nSuprathresholdResels" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of resels in the excursion set.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><em>y</em> — a 1D field</p>
<p><em>u</em> — threshold height</p>
<p><em>fwhm</em> — actual or estimated FWHM</p>
<p><em>interp</em> — interpolate to threshold <em>u</em></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>nResels</em> — number of resels which survive the threshold <em>u</em></p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nResels</span> <span class="o">=</span> <span class="n">calc</span><span class="o">.</span><span class="n">nSuprathresholdResels</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is a length measure, so is similar to (<strong>nSuprathresholdNodes</strong> minus <strong>nUpcrossings</strong>) divided by the FWHM, with the exception that extents can be interpolated to <em>u</em>.</p>
</div>
<div class="admonition danger">
<p class="admonition-title">Danger</p>
<p>Setting <em>interp</em> to False is faster, but it will cause disagreements between node-based and element-based sampling. If the upcrossing is large this difference is negligible, but for small upcrossing there may be strange results (e.g. upcrossing with an extent of zero). Recommendation: <strong>always interpolate</strong>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rft1d.geom.ClusterMetricCalculator.nUpcrossings">
<span class="sig-name descname"><span class="pre">nUpcrossings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rft1d.geom.ClusterMetricCalculator.nUpcrossings" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of upcrossings.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><em>y</em> — a 1D field</p>
<p><em>u</em> — threshold height</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>c</em> — number of upcrossings</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">calc</span><span class="o">.</span><span class="n">nUpcrossings</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rft1d.geom.ClusterMetricCalculator.nUpcrossingsByExtent">
<span class="sig-name descname"><span class="pre">nUpcrossingsByExtent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wrap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rft1d.geom.ClusterMetricCalculator.nUpcrossingsByExtent" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of upcrossings at threshold extent <em>k</em>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><em>y</em> — a 1D field</p>
<p><em>u</em> — threshold height</p>
<p><em>k</em> — cluster extent threshold (unit: nodes)</p>
<p><em>interp</em> — interpolate to threshold <em>u</em></p>
<p><em>wrap</em> — wrap upcrossings from the end to the start of the field</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>c</em> — number of upcrossings whose extents equal or exceed <em>k</em></p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">calc</span><span class="o">.</span><span class="n">nUpcrossingsByExtent</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<div class="admonition danger">
<p class="admonition-title">Danger</p>
<p>Setting <em>interp</em> to False is faster, but it will cause disagreements between node-based and element-based sampling. If the upcrossing is large this difference is negligible, but for small upcrossing there may be strange results (e.g. upcrossing with an extent of zero). Recommendation: <strong>always interpolate</strong>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rft1d.geom.ClusterMetricCalculator.total_excursion_set_extent">
<span class="sig-name descname"><span class="pre">total_excursion_set_extent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rft1d.geom.ClusterMetricCalculator.total_excursion_set_extent" title="Permalink to this definition">¶</a></dt>
<dd><p>Total extent of the excursion set.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><em>y</em> — a 1D field</p>
<p><em>u</em> — threshold height</p>
<p><em>fwhm</em> — actual or estimated FWHM</p>
<p><em>interp</em> — interpolate to threshold <em>u</em></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>k</em> — total extent of the excursion set <em>u</em></p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nResels</span> <span class="o">=</span> <span class="n">calc</span><span class="o">.</span><span class="n">total_excursion_set_extent</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt class="field-even">Note</dt>
<dd class="field-even"><p>This is a length measure, so is similar to <strong>nSuprathresholdNodes</strong> minus <strong>nUpcrossings</strong>, with the exception that extents can be interpolated to <em>u</em>.</p>
</dd>
</dl>
<div class="admonition danger">
<p class="admonition-title">Danger</p>
<p>Setting <em>interp</em> to False is faster, but it will cause disagreements between node-based and element-based sampling. If the upcrossing is large this difference is negligible, but for small upcrossing there may be strange results (e.g. upcrossing with an extent of zero). Recommendation: <strong>always interpolate</strong>.</p>
</div>
</dd></dl>

</dd></dl>

</section>
</section>
</section>


          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="distributions.html" class="btn btn-neutral float-left" title="rft1d.distributions" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="prob.html" class="btn btn-neutral float-right" title="rft1d.prob" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Todd Pataky.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>

    </section>

  </div>
  

  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.2.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/documentation_options.js"></script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>


