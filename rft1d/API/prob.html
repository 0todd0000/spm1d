

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>rft1d.prob &mdash; rft1d 0.2.0 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
  
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  
    <link rel="stylesheet" href="../_static/plot_directive.css" type="text/css" />
  
    <link rel="stylesheet" href="../_static/theme.css" type="text/css" />
  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="rft1d 0.2.0 documentation" href="../index.html"/>
        <link rel="up" title="API" href="../API.html"/>
        <link rel="next" title="rft1d.random" href="random.html"/>
        <link rel="prev" title="rft1d.geom" href="geom.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div>
		<!-- <a href="../index.html"><img src="_static/rft1d.png" alt="rft1d.png"</a> -->
		<!-- <img src="_static/rft1d.png" alt="rft1d.png"</img> -->
		<img src="../_static/rft1d.png" alt="rft1d.png"</img>
      </div>


      <div class="wy-side-nav-search">
        <!-- <a href="../index.html" class="fa fa-home"> rft1d</a> -->
		
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        <a href="../index.html" class="fa fa-home"> rft1d</a>
		<!-- <img src="./rft1d.png" alt="rft1d.png"> -->
		
        
            <ul>
<li class="toctree-l1"><a class="reference internal" href="../Download.html">Download</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../Download.html#automated-installation">Automated installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Download.html#source-code-download">Source code download</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Download.html#release-notes">Release Notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Download.html#license-information">License information</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Download.html#license-agreement-for-rft1d">License agreement for rft1d</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Theory.html">RFT Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../Theory.html#gaussian-random-fields">Gaussian random fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Theory.html#expected-field-maximum">Expected field maximum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Theory.html#upcrossings">Upcrossings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Theory.html#expected-upcrossing-geometry">Expected upcrossing geometry</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Examples.html">Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../Examples/Basic.html">Basic</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Examples/BrokenFields.html">Broken fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Examples/Validation.html">Validation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Examples/Application.html">Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Examples/Paper.html">Results from the paper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Examples/List.html">Scripts (overview)</a></li>
</ul>
</li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../API.html">API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="data.html">rft1d.data</a></li>
<li class="toctree-l2"><a class="reference internal" href="distributions.html">rft1d.distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="geom.html">rft1d.geom</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">rft1d.prob</a></li>
<li class="toctree-l2"><a class="reference internal" href="random.html">rft1d.random</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../References.html">References</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../References.html#on-the-web">On the web</a></li>
<li class="toctree-l2"><a class="reference internal" href="../References.html#software">Software</a></li>
<li class="toctree-l2"><a class="reference internal" href="../References.html#literature">Literature</a></li>
</ul>
</li>
</ul>

        
		
      </div>
	  
	  
      <!-- <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        <a href="../index.html" class="fa fa-home"> rft1d</a>
      </div> -->
	  
      <!-- <div class="wy-side-nav-search">
        <a href="../index.html" class="fa fa-home"> rft1d</a>
		
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div> -->
	  
	  
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">rft1d</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../API.html">API</a> &raquo;</li>
      
    <li>rft1d.prob</li>
      <li class="wy-breadcrumbs-aside">
        
          <!-- <a href="../_sources/API/prob.rst.txt" rel="nofollow"> View page source</a> -->
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            
  <section id="module-rft1d.prob">
<span id="rft1d-prob"></span><span id="label-api-prob"></span><h1>rft1d.prob<a class="headerlink" href="#module-rft1d.prob" title="Permalink to this heading">¶</a></h1>
<p>Random Field Theory expectations and probabilities.
The core RFT computations are conducted inside <strong>prob.rft</strong>, and the 
<strong>RFTCalculator</strong> class serves as a high-level interface to <strong>prob.rft</strong></p>
<section id="core-rft-computations">
<h2>Core RFT computations<a class="headerlink" href="#core-rft-computations" title="Permalink to this heading">¶</a></h2>
<dl class="py method">
<dt class="sig sig-object py" id="rft1d.prob.rft">
<span class="sig-prename descclassname"><span class="pre">prob.</span></span><span class="sig-name descname"><span class="pre">rft</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">STAT</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Q</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expectations_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'spm12'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_0d_check</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rft1d.prob.rft" title="Permalink to this definition">¶</a></dt>
<dd><p>Random Field Theory probabilities and expectations using unified Euler Characteristic (EC) theory.
This code is based on “spm_P_RF.m” and “spm_P.m” from the spm8 and spm12 Matlab packages
which are available from: <a class="reference external" href="http://www.fil.ion.ucl.ac.uk/spm/">http://www.fil.ion.ucl.ac.uk/spm/</a></p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>c</em> — number of clusters</p>
<p><em>k</em> — cluster extent (resels)</p>
<p><em>STAT</em> — test statistic (one of:  “Z”, “T”, “F”, “X2”, “T2”)</p>
<p><em>Z</em> — field height</p>
<p><em>df</em> — degrees of freedom [df{interest} df{error}]</p>
<p><em>R</em> — resel counts (0D counts, 1D counts) defining search volume</p>
<p><em>n</em> — number of test statistic fields in conjunction</p>
<p><em>Q</em> — number of field nodes (used for Bonferroni comparison)</p>
<p><em>expectations_only</em> — if True only expectations will be returned</p>
<p><em>version</em> — “spm8” or “spm12” (see below)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>P</em>  — corrected P value</p>
<p><em>p</em>  — uncorrected P value</p>
<p><em>Ec</em> — expected number of upcrossings {c}</p>
<p><em>Ek</em> — expected resels per upcrossing {k}</p>
<p><em>EN</em> — expected excursion set resels</p>
<p>NOTE!  If expectations_only==True, then only (Ec,Ek,EN) are returned.</p>
</dd>
<dt class="field-odd">Examples<span class="colon">:</span></dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">P</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">Ec</span><span class="p">,</span><span class="n">Ek</span><span class="p">,</span><span class="n">EN</span> <span class="o">=</span> <span class="n">rft1d</span><span class="o">.</span><span class="n">prob</span><span class="o">.</span><span class="n">rft</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span>
</pre></div>
</div>
</dd>
<dt class="field-even">Notes<span class="colon">:</span></dt>
<dd class="field-even"><p>1. The spm8 and spm12 Matlab functions on which this code is based were
developed by K.Friston and other members of the Wellcome Trust Centre for
Neuroimaging. This function makes minor modifications to those procedures
to take advantage of the simplicity of the 1D case.</p>
<p>2. Results for the spm8 and spm12 versions can be obtained via the
keyword “version”. When expected ECs approach zero, the spm8 and spm12
results will diverge slightly, due to a minor modification in spm12:
In spm8: “EC = EC + eps”.
In spm12: “EC = np.array([max(ec,eps) for ec in EC])”</p>
<p>3. Setting <em>c</em> and <em>k</em> in particular manners will yield important
probabilities. Consider these three cases:</p>
<ol class="loweralpha simple">
<li><p>rft(1, 0, STAT, Z, R)  — field maximum</p></li>
<li><p>rft(1, k, STAT, u, R)  — cluster-based inference</p></li>
<li><p>rft(c, k, STAT, u, R)  — set-based inference</p></li>
</ol>
<p>(a) is the probability that Gaussian fields will produce 1 upcrossing
with an extent of 0. Thus this pertains to the maximum of height of
Gaussian fields, and can be used, for example, for critical threshold
computations.</p>
<p>(b) is the probability that Gaussian fields, when thresholded at <em>u</em>,
will produce 1 upcrossing with an extent of <em>k</em>. This is used for
cluster-level inference (i.e. p values for individual upcrossings).</p>
<p>(c) is the probability that Gaussian fields, when thresholded at <em>u</em>,
will produce <em>c</em> upcrossings with a minimum extent of <em>k</em>. This is
used for set-level inference (i.e. p values for the entire result).</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Set-based inference (c) is more powerful than cluster-based inference (b), but unlike (b) it has no localizing information; it is a global p value pertaining to the entire excursion set en masse. It will thus always be lower than (b).</p>
</div>
<p>4. If Q==None, then no Bonferroni check is made. If Q!=None, the RFT
correction will be compared to Bonferroni correction, and the less
severe correction will be returned. This will only have an effect
for very rough fields, for example: when then second resel count
approaches 0.5*Q.</p>
</dd>
<dt class="field-odd">References<span class="colon">:</span></dt>
<dd class="field-odd"><ol class="arabic simple">
<li><p>Hasofer AM (1978) Upcrossings of random fields. Suppl Adv Appl
Prob 10:14-21.</p></li>
<li><p>Friston KJ et al (1994) Assessing the significance of focal
activations using their spatial extent. Human Brain Mapping 1:
210-220.</p></li>
<li><p>Worsley KJ et al (1996) A unified statistical approach for
determining significant signals in images of cerebral
activation. Human Brain Mapping 4:58-73.</p></li>
</ol>
</dd>
</dl>
</dd></dl>

</section>
<section id="high-level-interface-to-rft-computations">
<h2>High-level interface to RFT computations<a class="headerlink" href="#high-level-interface-to-rft-computations" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="rft1d.prob.RFTCalculator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">rft1d.prob.</span></span><span class="sig-name descname"><span class="pre">RFTCalculator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">STAT</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Z'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nodes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FWHM</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">withBonf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'spm12'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rft1d.prob.RFTCalculator" title="Permalink to this definition">¶</a></dt>
<dd><p>A convenience class for high-level access to RFT probabilities.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>STAT</em> — test statistic (one of:  “Z”, “T”, “F”, “X2”, “T2”)</p>
<p><em>df</em> — degrees of freedom [df{interest} df{error}]</p>
<p><em>nodes</em> — number of field nodes (int)  OR a binary field (boolean array)</p>
<p><em>FWHM</em> — field smoothness (float)</p>
<p><em>n</em> — number of test statistic fields in conjunction</p>
<p><em>withBonf</em> — use a Bonferroni correction if less severe than the RFT correction</p>
<p><em>version</em> — “spm8” or “spm12” (see below)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An instance of the RFTCalculator class.</p>
</dd>
<dt class="field-odd">Attributes<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>expected</em> — access to RFT expectations</p>
<p><em>p</em> — access to RFT probabilities</p>
</dd>
<dt class="field-even">Methods<span class="colon">:</span></dt>
<dd class="field-even"><p><em>isf</em> — inverse survival function</p>
<p><em>sf</em> — survival function</p>
</dd>
<dt class="field-odd">Examples<span class="colon">:</span></dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">calc</span> <span class="o">=</span> <span class="n">rft1d</span><span class="o">.</span><span class="n">prob</span><span class="o">.</span><span class="n">RFTCalculator</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span> <span class="mi">101</span><span class="p">,</span> <span class="mf">15.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">calc</span><span class="o">.</span><span class="n">expected</span><span class="o">.</span><span class="n">number_of_upcrossings</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="c1">#yields 1.343</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">calc</span><span class="o">.</span><span class="n">expected</span><span class="o">.</span><span class="n">number_of_upcrossings</span><span class="p">(</span><span class="mf">4.5</span><span class="p">)</span> <span class="c1">#yields 0.0223</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="rft1d.prob.RFTCalculator.isf">
<span class="sig-name descname"><span class="pre">isf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rft1d.prob.RFTCalculator.isf" title="Permalink to this definition">¶</a></dt>
<dd><p>Inverse survival function.
(see also the survival function: <strong>RFTCalculator.sf</strong>)</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>alpha</em> – upper tail probability (float;  0 &lt; alpha &lt; 1)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Quantile corresponding to upper-tail probability alpha.
Equivalently: critical threshold at a Type I error rate of alpha.</p>
</dd>
<dt class="field-odd">Examples<span class="colon">:</span></dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">calc</span> <span class="o">=</span> <span class="n">rft1d</span><span class="o">.</span><span class="n">prob</span><span class="o">.</span><span class="n">RFTCalculator</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span> <span class="mi">101</span><span class="p">,</span> <span class="mf">15.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">calc</span><span class="o">.</span><span class="n">isf</span><span class="p">(</span><span class="mf">0.05</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rft1d.prob.RFTCalculator.sf">
<span class="sig-name descname"><span class="pre">sf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rft1d.prob.RFTCalculator.sf" title="Permalink to this definition">¶</a></dt>
<dd><p>Survival function.
(Equivalent to <strong>RFTCalculator.p.upcrossing</strong>)</p>
<p>Probability that 1D Gaussian fields with a smoothness <em>FWHM</em> would produce a 1D statistic field whose maximum exceeds <em>u</em>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>u</em> – threshold (int, float, or sequence of int or float)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The probability of exceeding the specified heights.</p>
</dd>
<dt class="field-odd">Examples<span class="colon">:</span></dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">calc</span> <span class="o">=</span> <span class="n">rft1d</span><span class="o">.</span><span class="n">prob</span><span class="o">.</span><span class="n">RFTCalculator</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span> <span class="mi">101</span><span class="p">,</span> <span class="mf">15.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">calc</span><span class="o">.</span><span class="n">sf</span><span class="p">(</span><span class="mf">3.5</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

</dd></dl>

<section id="expectations-rftcalculator-expected">
<h3>Expectations (RFTCalculator.expected)<a class="headerlink" href="#expectations-rftcalculator-expected" title="Permalink to this heading">¶</a></h3>
<blockquote>
<div><dl class="py method">
<dt class="sig sig-object py" id="rft1d.prob.expected.nodes_per_upcrossing">
<span class="sig-prename descclassname"><span class="pre">expected.</span></span><span class="sig-name descname"><span class="pre">nodes_per_upcrossing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rft1d.prob.expected.nodes_per_upcrossing" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of nodes expected for each uprcrossing at threshold <em>u</em>.</p>
<dl class="field-list">
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">calc</span> <span class="o">=</span> <span class="n">rft1d</span><span class="o">.</span><span class="n">prob</span><span class="o">.</span><span class="n">RFTCalculator</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span> <span class="mi">101</span><span class="p">,</span> <span class="mf">15.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">calc</span><span class="o">.</span><span class="n">expected</span><span class="o">.</span><span class="n">nodes_per_upcrossing</span><span class="p">(</span><span class="mf">2.7</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is a node count, so is equivalent to: (FWHM x <strong>resels_per_upcrossing</strong>)  + 1</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rft1d.prob.expected.number_of_upcrossings">
<span class="sig-prename descclassname"><span class="pre">expected.</span></span><span class="sig-name descname"><span class="pre">number_of_upcrossings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rft1d.prob.expected.number_of_upcrossings" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of upcrossings expected for threshold <em>u</em>.</p>
<dl class="field-list">
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">calc</span> <span class="o">=</span> <span class="n">rft1d</span><span class="o">.</span><span class="n">prob</span><span class="o">.</span><span class="n">RFTCalculator</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span> <span class="mi">101</span><span class="p">,</span> <span class="mf">15.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">calc</span><span class="o">.</span><span class="n">expected</span><span class="o">.</span><span class="n">number_of_upcrossings</span><span class="p">(</span><span class="mf">2.7</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rft1d.prob.expected.number_of_suprathreshold_nodes">
<span class="sig-prename descclassname"><span class="pre">expected.</span></span><span class="sig-name descname"><span class="pre">number_of_suprathreshold_nodes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rft1d.prob.expected.number_of_suprathreshold_nodes" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of nodes expected in the entire excursion set at threshold <em>u</em>.
These nodes can come from multiple upcrossings.</p>
<dl class="field-list">
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">calc</span> <span class="o">=</span> <span class="n">rft1d</span><span class="o">.</span><span class="n">prob</span><span class="o">.</span><span class="n">RFTCalculator</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span> <span class="mi">101</span><span class="p">,</span> <span class="mf">15.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">calc</span><span class="o">.</span><span class="n">expected</span><span class="o">.</span><span class="n">number_of_suprathreshold_nodes</span><span class="p">(</span><span class="mf">2.8</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is a node count, so is equivalent to: (FWHM x <strong>number_of_suprathreshold_resels</strong>)  + <strong>number_of_upcrossings</strong></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rft1d.prob.expected.number_of_suprathreshold_resels">
<span class="sig-prename descclassname"><span class="pre">expected.</span></span><span class="sig-name descname"><span class="pre">number_of_suprathreshold_resels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rft1d.prob.expected.number_of_suprathreshold_resels" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of resels expected in the entire excursion set at threshold <em>u</em>.
These resels can come from multiple upcrossings.
One resel contains (1 x FWHM) nodes.
Thus this is equivalent to:  (FWHM x number_of_suprathreshold_nodes)</p>
<dl class="field-list">
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">calc</span> <span class="o">=</span> <span class="n">rft1d</span><span class="o">.</span><span class="n">prob</span><span class="o">.</span><span class="n">RFTCalculator</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span> <span class="mi">101</span><span class="p">,</span> <span class="mf">15.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">calc</span><span class="o">.</span><span class="n">expected</span><span class="o">.</span><span class="n">number_of_suprathreshold_resels</span><span class="p">(</span><span class="mf">2.9</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rft1d.prob.expected.resels_per_upcrossing">
<span class="sig-prename descclassname"><span class="pre">expected.</span></span><span class="sig-name descname"><span class="pre">resels_per_upcrossing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rft1d.prob.expected.resels_per_upcrossing" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of nodes expected for each uprcrossing at threshold <em>u</em>.
One resel contains (1 x FWHM) nodes.
Thus this is equivalent to:  (FWHM x nodes_per_upcrossing)</p>
<dl class="field-list">
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">calc</span> <span class="o">=</span> <span class="n">rft1d</span><span class="o">.</span><span class="n">prob</span><span class="o">.</span><span class="n">RFTCalculator</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span> <span class="mi">101</span><span class="p">,</span> <span class="mf">15.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">calc</span><span class="o">.</span><span class="n">expected</span><span class="o">.</span><span class="n">resels_per_upcrossing</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

</div></blockquote>
</section>
<section id="probabilities-rftcalculator-p">
<h3>Probabilities (RFTCalculator.p)<a class="headerlink" href="#probabilities-rftcalculator-p" title="Permalink to this heading">¶</a></h3>
<blockquote>
<div><dl class="py method">
<dt class="sig sig-object py" id="rft1d.prob.p.cluster">
<span class="sig-prename descclassname"><span class="pre">p.</span></span><span class="sig-name descname"><span class="pre">cluster</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rft1d.prob.p.cluster" title="Permalink to this definition">¶</a></dt>
<dd><p>Cluster-level inference.</p>
<p>Probability that 1D Gaussian fields would produce an upcrossing of extent <em>k</em>
when thresholded at <em>u</em>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The threshold <em>u</em> should generally be chosen objectively. One possibility is to calculate the <em>alpha</em>-based critical threshold using the inverse survival function: <strong>RFTCalculator.isf</strong></p>
</div>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>k</em> – cluster extent (resels)</p>
<p><em>u</em> – threshold</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Cluster-specific probability value.</p>
</dd>
<dt class="field-odd">Examples<span class="colon">:</span></dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">calc</span> <span class="o">=</span> <span class="n">rft1d</span><span class="o">.</span><span class="n">prob</span><span class="o">.</span><span class="n">RFTCalculator</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span> <span class="mi">101</span><span class="p">,</span> <span class="mf">15.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">calc</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">cluster</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rft1d.prob.p.set">
<span class="sig-prename descclassname"><span class="pre">p.</span></span><span class="sig-name descname"><span class="pre">set</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rft1d.prob.p.set" title="Permalink to this definition">¶</a></dt>
<dd><p>Set-level inference.</p>
<p>Probability that 1D Gaussian fields would produce at least <em>c</em> upcrossings
with a minimum extent of <em>k</em> when thresholded at <em>u</em>.
This probability pertains to the entire excursion set.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The threshold <em>u</em> should generally be chosen objectively. One possibility is to calculate the <em>alpha</em>-based critical threshold using the inverse survival function: <strong>RFTCalculator.isf</strong></p>
</div>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>c</em> – number of upcrossings</p>
<p><em>k</em> – minimum cluster extent (resels)</p>
<p><em>u</em> – threshold</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Set-specific probability value.</p>
</dd>
<dt class="field-odd">Examples<span class="colon">:</span></dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">calc</span> <span class="o">=</span> <span class="n">rft1d</span><span class="o">.</span><span class="n">prob</span><span class="o">.</span><span class="n">RFTCalculator</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span> <span class="mi">101</span><span class="p">,</span> <span class="mf">15.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">calc</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">2.7</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rft1d.prob.p.upcrossing">
<span class="sig-prename descclassname"><span class="pre">p.</span></span><span class="sig-name descname"><span class="pre">upcrossing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rft1d.prob.p.upcrossing" title="Permalink to this definition">¶</a></dt>
<dd><p>Survival function (equivalent to <strong>RFTCalculator.sf</strong>)</p>
<p>Probability that 1D Gaussian fields would produce a 1D statistic field whose maximum exceeds <em>u</em>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>u</em> – threshold (int, float, or sequence of int or float)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The probability of exceeding the specified heights.</p>
</dd>
<dt class="field-odd">Examples<span class="colon">:</span></dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">calc</span> <span class="o">=</span> <span class="n">rft1d</span><span class="o">.</span><span class="n">prob</span><span class="o">.</span><span class="n">RFTCalculator</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span> <span class="mi">101</span><span class="p">,</span> <span class="mf">15.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">calc</span><span class="o">.</span><span class="n">sf</span><span class="p">(</span><span class="mf">3.5</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

</div></blockquote>
</section>
</section>
<section id="bonferroni-correction">
<h2>Bonferroni correction<a class="headerlink" href="#bonferroni-correction" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><dl class="py method">
<dt class="sig sig-object py" id="rft1d.prob.p_bonferroni">
<span class="sig-prename descclassname"><span class="pre">prob.</span></span><span class="sig-name descname"><span class="pre">p_bonferroni</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rft1d.prob.p_bonferroni" title="Permalink to this definition">¶</a></dt>
<dd><p>Bonferroni correction.</p>
<p>When fields are very rough a Bonferroni correction might be less severe than
the RFT threshold. This function yields Bonferroni-corrected p values based
on the number of field nodes <em>Q</em>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>STAT</em> — test statistic (one of:  “Z”, “T”, “F”, “X2”, “T2”)</p>
<p><em>z</em> — field height</p>
<p><em>df</em> — degrees of freedom [df{interest} df{error}]</p>
<p><em>Q</em> — number of field nodes (used for Bonferroni comparison)</p>
<p><em>n</em> — number of test statistic fields in conjunction</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The probability of exceeding the specified height.</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rft1d</span><span class="o">.</span><span class="n">prob</span><span class="o">.</span><span class="n">p_bonferroni</span><span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="mf">3.1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">101</span><span class="p">)</span> <span class="c1">#yields 0.098</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

</div></blockquote>
</section>
</section>


          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="geom.html" class="btn btn-neutral float-left" title="rft1d.geom" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="random.html" class="btn btn-neutral float-right" title="rft1d.random" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Todd Pataky.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>

    </section>

  </div>
  

  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.2.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/documentation_options.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/sphinx_highlight.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>


