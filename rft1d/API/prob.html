

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>rft1d.prob &mdash; rft1d 0.1.1 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
  
    <link rel="stylesheet" href="../_static/theme.css" type="text/css" />
  
    <link rel="top" title="rft1d 0.1.1 documentation" href="../index.html"/>
        <link rel="up" title="API" href="../API.html"/>
        <link rel="next" title="rft1d.random" href="random.html"/>
        <link rel="prev" title="rft1d.geom" href="geom.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div>
		<!-- <a href="../index.html"><img src="_static/rft1d.png" alt="rft1d.png"</a> -->
		<!-- <img src="_static/rft1d.png" alt="rft1d.png"</img> -->
		<img src="../_static/rft1d.png" alt="rft1d.png"</img>
      </div>


      <div class="wy-side-nav-search">
        <!-- <a href="../index.html" class="fa fa-home"> rft1d</a> -->
		<div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        <a href="../index.html" class="fa fa-home"> rft1d</a>
		<!-- <img src="./rft1d.png" alt="rft1d.png"> -->
		
        
            <ul>
<li class="toctree-l1"><a class="reference internal" href="../Download.html">Download</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../Download.html#automated-installation">Automated installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Download.html#source-code-download">Source code download</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Download.html#release-notes">Release Notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Download.html#license-information">License information</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Download.html#license-agreement-for-rft1d">License agreement for rft1d</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Theory.html">RFT Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../Theory.html#gaussian-random-fields">Gaussian random fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Theory.html#expected-field-maximum">Expected field maximum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Theory.html#upcrossings">Upcrossings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Theory.html#expected-upcrossing-geometry">Expected upcrossing geometry</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Examples.html">Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../Examples/Basic.html">Basic</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Examples/BrokenFields.html">Broken fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Examples/Validation.html">Validation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Examples/Application.html">Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Examples/Paper.html">Results from the paper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Examples/List.html">Scripts (overview)</a></li>
</ul>
</li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../API.html">API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="data.html">rft1d.data</a></li>
<li class="toctree-l2"><a class="reference internal" href="distributions.html">rft1d.distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="geom.html">rft1d.geom</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">rft1d.prob</a></li>
<li class="toctree-l2"><a class="reference internal" href="random.html">rft1d.random</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../References.html">References</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../References.html#on-the-web">On the web</a></li>
<li class="toctree-l2"><a class="reference internal" href="../References.html#software">Software</a></li>
<li class="toctree-l2"><a class="reference internal" href="../References.html#literature">Literature</a></li>
</ul>
</li>
</ul>

        
		
      </div>
	  
	  
      <!-- <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        <a href="../index.html" class="fa fa-home"> rft1d</a>
      </div> -->
	  
      <!-- <div class="wy-side-nav-search">
        <a href="../index.html" class="fa fa-home"> rft1d</a>
		<div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div> -->
	  
	  
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">rft1d</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../API.html">API</a> &raquo;</li>
      
    <li>rft1d.prob</li>
      <li class="wy-breadcrumbs-aside">
        
          <!-- <a href="../_sources/API/prob.txt" rel="nofollow"> View page source</a> -->
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            
  <div class="section" id="module-rft1d.prob">
<span id="rft1d-prob"></span><span id="label-api-prob"></span><h1>rft1d.prob<a class="headerlink" href="#module-rft1d.prob" title="Permalink to this headline">¶</a></h1>
<p>Random Field Theory expectations and probabilities.
The core RFT computations are conducted inside <strong>prob.rft</strong>, and the 
<strong>RFTCalculator</strong> class serves as a high-level interface to <strong>prob.rft</strong></p>
<div class="section" id="core-rft-computations">
<h2>Core RFT computations<a class="headerlink" href="#core-rft-computations" title="Permalink to this headline">¶</a></h2>
<dl class="method">
<dt id="rft1d.prob.rft">
<code class="descclassname">prob.</code><code class="descname">rft</code><span class="sig-paren">(</span><em>c</em>, <em>k</em>, <em>STAT</em>, <em>Z</em>, <em>df</em>, <em>R</em>, <em>n=1</em>, <em>Q=None</em>, <em>expectations_only=False</em>, <em>version='spm12'</em><span class="sig-paren">)</span><a class="headerlink" href="#rft1d.prob.rft" title="Permalink to this definition">¶</a></dt>
<dd><p>Random Field Theory probabilities and expectations using unified Euler Characteristic (EC) theory.
This code is based on &#8220;spm_P_RF.m&#8221; and &#8220;spm_P.m&#8221; from the spm8 and spm12 Matlab packages
which are available from: <a class="reference external" href="http://www.fil.ion.ucl.ac.uk/spm/">http://www.fil.ion.ucl.ac.uk/spm/</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><em>c</em> &#8212; number of clusters</p>
<p><em>k</em> &#8212; cluster extent (resels)</p>
<p><em>STAT</em> &#8212; test statistic (one of:  &#8220;Z&#8221;, &#8220;T&#8221;, &#8220;F&#8221;, &#8220;X2&#8221;, &#8220;T2&#8221;)</p>
<p><em>Z</em> &#8212; field height</p>
<p><em>df</em> &#8212; degrees of freedom [df{interest} df{error}]</p>
<p><em>R</em> &#8212; resel counts (0D counts, 1D counts) defining search volume</p>
<p><em>n</em> &#8212; number of test statistic fields in conjunction</p>
<p><em>Q</em> &#8212; number of field nodes (used for Bonferroni comparison)</p>
<p><em>expectations_only</em> &#8212; if True only expectations will be returned</p>
<p><em>version</em> &#8212; &#8220;spm8&#8221; or &#8220;spm12&#8221; (see below)</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><em>P</em>  &#8212; corrected P value</p>
<p><em>p</em>  &#8212; uncorrected P value</p>
<p><em>Ec</em> &#8212; expected number of upcrossings {c}</p>
<p><em>Ek</em> &#8212; expected resels per upcrossing {k}</p>
<p><em>EN</em> &#8212; expected excursion set resels</p>
<p>NOTE!  If expectations_only==True, then only (Ec,Ek,EN) are returned.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Examples:</th><td class="field-body"><div class="first highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">P</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">Ec</span><span class="p">,</span><span class="n">Ek</span><span class="p">,</span><span class="n">EN</span> <span class="o">=</span> <span class="n">rft1d</span><span class="o">.</span><span class="n">prob</span><span class="o">.</span><span class="n">rft</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&#39;T&#39;</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span>
</pre></div>
</div>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Notes:</th><td class="field-body"><p class="first">1. The spm8 and spm12 Matlab functions on which this code is based were
developed by K.Friston and other members of the Wellcome Trust Centre for
Neuroimaging. This function makes minor modifications to those procedures
to take advantage of the simplicity of the 1D case.</p>
<p>2. Results for the spm8 and spm12 versions can be obtained via the
keyword &#8220;version&#8221;. When expected ECs approach zero, the spm8 and spm12
results will diverge slightly, due to a minor modification in spm12:
In spm8: &#8220;EC = EC + eps&#8221;.
In spm12: &#8220;EC = np.array([max(ec,eps) for ec in EC])&#8221;</p>
<p>3. Setting <em>c</em> and <em>k</em> in particular manners will yield important
probabilities. Consider these three cases:</p>
<ol class="loweralpha simple">
<li>rft(1, 0, STAT, Z, R)  &#8212; field maximum</li>
<li>rft(1, k, STAT, u, R)  &#8212; cluster-based inference</li>
<li>rft(c, k, STAT, u, R)  &#8212; set-based inference</li>
</ol>
<p>(a) is the probability that Gaussian fields will produce 1 upcrossing
with an extent of 0. Thus this pertains to the maximum of height of
Gaussian fields, and can be used, for example, for critical threshold
computations.</p>
<p>(b) is the probability that Gaussian fields, when thresholded at <em>u</em>,
will produce 1 upcrossing with an extent of <em>k</em>. This is used for
cluster-level inference (i.e. p values for individual upcrossings).</p>
<p>(c) is the probability that Gaussian fields, when thresholded at <em>u</em>,
will produce <em>c</em> upcrossings with a minimum extent of <em>k</em>. This is
used for set-level inference (i.e. p values for the entire result).</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Set-based inference (c) is more powerful than cluster-based inference (b), but unlike (b) it has no localizing information; it is a global p value pertaining to the entire excursion set en masse. It will thus always be lower than (b).</p>
</div>
<p>4. If Q==None, then no Bonferroni check is made. If Q!=None, the RFT
correction will be compared to Bonferroni correction, and the less
severe correction will be returned. This will only have an effect
for very rough fields, for example: when then second resel count
approaches 0.5*Q.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">References:</th><td class="field-body"><ol class="first last arabic simple">
<li>Hasofer AM (1978) Upcrossings of random fields. Suppl Adv Appl
Prob 10:14-21.</li>
<li>Friston KJ et al (1994) Assessing the significance of focal
activations using their spatial extent. Human Brain Mapping 1:
210-220.</li>
<li>Worsley KJ et al (1996) A unified statistical approach for
determining significant signals in images of cerebral
activation. Human Brain Mapping 4:58-73.</li>
</ol>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="high-level-interface-to-rft-computations">
<h2>High-level interface to RFT computations<a class="headerlink" href="#high-level-interface-to-rft-computations" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="rft1d.prob.RFTCalculator">
<em class="property">class </em><code class="descclassname">rft1d.prob.</code><code class="descname">RFTCalculator</code><span class="sig-paren">(</span><em>STAT='Z'</em>, <em>df=None</em>, <em>nodes=101</em>, <em>FWHM=10.0</em>, <em>n=1</em>, <em>withBonf=False</em>, <em>version='spm12'</em><span class="sig-paren">)</span><a class="headerlink" href="#rft1d.prob.RFTCalculator" title="Permalink to this definition">¶</a></dt>
<dd><p>A convenience class for high-level access to RFT probabilities.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><em>STAT</em> &#8212; test statistic (one of:  &#8220;Z&#8221;, &#8220;T&#8221;, &#8220;F&#8221;, &#8220;X2&#8221;, &#8220;T2&#8221;)</p>
<p><em>df</em> &#8212; degrees of freedom [df{interest} df{error}]</p>
<p><em>nodes</em> &#8212; number of field nodes (int)  OR a binary field (boolean array)</p>
<p><em>FWHM</em> &#8212; field smoothness (float)</p>
<p><em>n</em> &#8212; number of test statistic fields in conjunction</p>
<p><em>withBonf</em> &#8212; use a Bonferroni correction if less severe than the RFT correction</p>
<p><em>version</em> &#8212; &#8220;spm8&#8221; or &#8220;spm12&#8221; (see below)</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">An instance of the RFTCalculator class.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Attributes:</th><td class="field-body"><p class="first"><em>expected</em> &#8212; access to RFT expectations</p>
<p><em>p</em> &#8212; access to RFT probabilities</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Methods:</th><td class="field-body"><p class="first"><em>isf</em> &#8212; inverse survival function</p>
<p><em>sf</em> &#8212; survival function</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Examples:</th><td class="field-body"><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">calc</span> <span class="o">=</span> <span class="n">rft1d</span><span class="o">.</span><span class="n">prob</span><span class="o">.</span><span class="n">RFTCalculator</span><span class="p">(</span><span class="s">&#39;T&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span> <span class="mi">101</span><span class="p">,</span> <span class="mf">15.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">calc</span><span class="o">.</span><span class="n">expected</span><span class="o">.</span><span class="n">number_of_upcrossings</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="c">#yields 1.343</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">calc</span><span class="o">.</span><span class="n">expected</span><span class="o">.</span><span class="n">number_of_upcrossings</span><span class="p">(</span><span class="mf">4.5</span><span class="p">)</span> <span class="c">#yields 0.0223</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="rft1d.prob.RFTCalculator.isf">
<code class="descname">isf</code><span class="sig-paren">(</span><em>alpha</em><span class="sig-paren">)</span><a class="headerlink" href="#rft1d.prob.RFTCalculator.isf" title="Permalink to this definition">¶</a></dt>
<dd><p>Inverse survival function.
(see also the survival function: <strong>RFTCalculator.sf</strong>)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><em>alpha</em> &#8211; upper tail probability (float;  0 &lt; alpha &lt; 1)</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Quantile corresponding to upper-tail probability alpha.
Equivalently: critical threshold at a Type I error rate of alpha.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Examples:</th><td class="field-body"><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">calc</span> <span class="o">=</span> <span class="n">rft1d</span><span class="o">.</span><span class="n">prob</span><span class="o">.</span><span class="n">RFTCalculator</span><span class="p">(</span><span class="s">&#39;T&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span> <span class="mi">101</span><span class="p">,</span> <span class="mf">15.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">calc</span><span class="o">.</span><span class="n">isf</span><span class="p">(</span><span class="mf">0.05</span><span class="p">)</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rft1d.prob.RFTCalculator.sf">
<code class="descname">sf</code><span class="sig-paren">(</span><em>u</em><span class="sig-paren">)</span><a class="headerlink" href="#rft1d.prob.RFTCalculator.sf" title="Permalink to this definition">¶</a></dt>
<dd><p>Survival function.
(Equivalent to <strong>RFTCalculator.p.upcrossing</strong>)</p>
<p>Probability that 1D Gaussian fields with a smoothness <em>FWHM</em> would produce a 1D statistic field whose maximum exceeds <em>u</em>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><em>u</em> &#8211; threshold (int, float, or sequence of int or float)</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The probability of exceeding the specified heights.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Examples:</th><td class="field-body"><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">calc</span> <span class="o">=</span> <span class="n">rft1d</span><span class="o">.</span><span class="n">prob</span><span class="o">.</span><span class="n">RFTCalculator</span><span class="p">(</span><span class="s">&#39;T&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span> <span class="mi">101</span><span class="p">,</span> <span class="mf">15.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">calc</span><span class="o">.</span><span class="n">sf</span><span class="p">(</span><span class="mf">3.5</span><span class="p">)</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<div class="section" id="expectations-rftcalculator-expected">
<h3>Expectations (RFTCalculator.expected)<a class="headerlink" href="#expectations-rftcalculator-expected" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><dl class="method">
<dt id="rft1d.prob.expected.nodes_per_upcrossing">
<code class="descclassname">expected.</code><code class="descname">nodes_per_upcrossing</code><span class="sig-paren">(</span><em>u</em><span class="sig-paren">)</span><a class="headerlink" href="#rft1d.prob.expected.nodes_per_upcrossing" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of nodes expected for each uprcrossing at threshold <em>u</em>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">calc</span> <span class="o">=</span> <span class="n">rft1d</span><span class="o">.</span><span class="n">prob</span><span class="o">.</span><span class="n">RFTCalculator</span><span class="p">(</span><span class="s">&#39;T&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span> <span class="mi">101</span><span class="p">,</span> <span class="mf">15.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">calc</span><span class="o">.</span><span class="n">expected</span><span class="o">.</span><span class="n">nodes_per_upcrossing</span><span class="p">(</span><span class="mf">2.7</span><span class="p">)</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This is a node count, so is equivalent to: (FWHM x <strong>resels_per_upcrossing</strong>)  + 1</p>
</div>
</dd></dl>

<dl class="method">
<dt id="rft1d.prob.expected.number_of_upcrossings">
<code class="descclassname">expected.</code><code class="descname">number_of_upcrossings</code><span class="sig-paren">(</span><em>u</em><span class="sig-paren">)</span><a class="headerlink" href="#rft1d.prob.expected.number_of_upcrossings" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of upcrossings expected for threshold <em>u</em>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">calc</span> <span class="o">=</span> <span class="n">rft1d</span><span class="o">.</span><span class="n">prob</span><span class="o">.</span><span class="n">RFTCalculator</span><span class="p">(</span><span class="s">&#39;T&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span> <span class="mi">101</span><span class="p">,</span> <span class="mf">15.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">calc</span><span class="o">.</span><span class="n">expected</span><span class="o">.</span><span class="n">number_of_upcrossings</span><span class="p">(</span><span class="mf">2.7</span><span class="p">)</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rft1d.prob.expected.number_of_suprathreshold_nodes">
<code class="descclassname">expected.</code><code class="descname">number_of_suprathreshold_nodes</code><span class="sig-paren">(</span><em>u</em><span class="sig-paren">)</span><a class="headerlink" href="#rft1d.prob.expected.number_of_suprathreshold_nodes" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of nodes expected in the entire excursion set at threshold <em>u</em>.
These nodes can come from multiple upcrossings.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">calc</span> <span class="o">=</span> <span class="n">rft1d</span><span class="o">.</span><span class="n">prob</span><span class="o">.</span><span class="n">RFTCalculator</span><span class="p">(</span><span class="s">&#39;T&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span> <span class="mi">101</span><span class="p">,</span> <span class="mf">15.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">calc</span><span class="o">.</span><span class="n">expected</span><span class="o">.</span><span class="n">number_of_suprathreshold_nodes</span><span class="p">(</span><span class="mf">2.8</span><span class="p">)</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This is a node count, so is equivalent to: (FWHM x <strong>number_of_suprathreshold_resels</strong>)  + <strong>number_of_upcrossings</strong></p>
</div>
</dd></dl>

<dl class="method">
<dt id="rft1d.prob.expected.number_of_suprathreshold_resels">
<code class="descclassname">expected.</code><code class="descname">number_of_suprathreshold_resels</code><span class="sig-paren">(</span><em>u</em><span class="sig-paren">)</span><a class="headerlink" href="#rft1d.prob.expected.number_of_suprathreshold_resels" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of resels expected in the entire excursion set at threshold <em>u</em>.
These resels can come from multiple upcrossings.
One resel contains (1 x FWHM) nodes.
Thus this is equivalent to:  (FWHM x number_of_suprathreshold_nodes)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">calc</span> <span class="o">=</span> <span class="n">rft1d</span><span class="o">.</span><span class="n">prob</span><span class="o">.</span><span class="n">RFTCalculator</span><span class="p">(</span><span class="s">&#39;T&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span> <span class="mi">101</span><span class="p">,</span> <span class="mf">15.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">calc</span><span class="o">.</span><span class="n">expected</span><span class="o">.</span><span class="n">number_of_suprathreshold_resels</span><span class="p">(</span><span class="mf">2.9</span><span class="p">)</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rft1d.prob.expected.resels_per_upcrossing">
<code class="descclassname">expected.</code><code class="descname">resels_per_upcrossing</code><span class="sig-paren">(</span><em>u</em><span class="sig-paren">)</span><a class="headerlink" href="#rft1d.prob.expected.resels_per_upcrossing" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of nodes expected for each uprcrossing at threshold <em>u</em>.
One resel contains (1 x FWHM) nodes.
Thus this is equivalent to:  (FWHM x nodes_per_upcrossing)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">calc</span> <span class="o">=</span> <span class="n">rft1d</span><span class="o">.</span><span class="n">prob</span><span class="o">.</span><span class="n">RFTCalculator</span><span class="p">(</span><span class="s">&#39;T&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span> <span class="mi">101</span><span class="p">,</span> <span class="mf">15.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">calc</span><span class="o">.</span><span class="n">expected</span><span class="o">.</span><span class="n">resels_per_upcrossing</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div></blockquote>
</div>
<div class="section" id="probabilities-rftcalculator-p">
<h3>Probabilities (RFTCalculator.p)<a class="headerlink" href="#probabilities-rftcalculator-p" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><dl class="method">
<dt id="rft1d.prob.p.cluster">
<code class="descclassname">p.</code><code class="descname">cluster</code><span class="sig-paren">(</span><em>k</em>, <em>u</em><span class="sig-paren">)</span><a class="headerlink" href="#rft1d.prob.p.cluster" title="Permalink to this definition">¶</a></dt>
<dd><p>Cluster-level inference.</p>
<p>Probability that 1D Gaussian fields would produce an upcrossing of extent <em>k</em>
when thresholded at <em>u</em>.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The threshold <em>u</em> should generally be chosen objectively. One possibility is to calculate the <em>alpha</em>-based critical threshold using the inverse survival function: <strong>RFTCalculator.isf</strong></p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><em>k</em> &#8211; cluster extent (resels)</p>
<p><em>u</em> &#8211; threshold</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Cluster-specific probability value.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Examples:</th><td class="field-body"><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">calc</span> <span class="o">=</span> <span class="n">rft1d</span><span class="o">.</span><span class="n">prob</span><span class="o">.</span><span class="n">RFTCalculator</span><span class="p">(</span><span class="s">&#39;T&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span> <span class="mi">101</span><span class="p">,</span> <span class="mf">15.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">calc</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">cluster</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">)</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rft1d.prob.p.set">
<code class="descclassname">p.</code><code class="descname">set</code><span class="sig-paren">(</span><em>c</em>, <em>k</em>, <em>u</em><span class="sig-paren">)</span><a class="headerlink" href="#rft1d.prob.p.set" title="Permalink to this definition">¶</a></dt>
<dd><p>Set-level inference.</p>
<p>Probability that 1D Gaussian fields would produce at least <em>c</em> upcrossings
with a minimum extent of <em>k</em> when thresholded at <em>u</em>.
This probability pertains to the entire excursion set.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The threshold <em>u</em> should generally be chosen objectively. One possibility is to calculate the <em>alpha</em>-based critical threshold using the inverse survival function: <strong>RFTCalculator.isf</strong></p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><em>c</em> &#8211; number of upcrossings</p>
<p><em>k</em> &#8211; minimum cluster extent (resels)</p>
<p><em>u</em> &#8211; threshold</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Set-specific probability value.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Examples:</th><td class="field-body"><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">calc</span> <span class="o">=</span> <span class="n">rft1d</span><span class="o">.</span><span class="n">prob</span><span class="o">.</span><span class="n">RFTCalculator</span><span class="p">(</span><span class="s">&#39;T&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span> <span class="mi">101</span><span class="p">,</span> <span class="mf">15.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">calc</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">2.7</span><span class="p">)</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rft1d.prob.p.upcrossing">
<code class="descclassname">p.</code><code class="descname">upcrossing</code><span class="sig-paren">(</span><em>u</em><span class="sig-paren">)</span><a class="headerlink" href="#rft1d.prob.p.upcrossing" title="Permalink to this definition">¶</a></dt>
<dd><p>Survival function (equivalent to <strong>RFTCalculator.sf</strong>)</p>
<p>Probability that 1D Gaussian fields would produce a 1D statistic field whose maximum exceeds <em>u</em>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><em>u</em> &#8211; threshold (int, float, or sequence of int or float)</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The probability of exceeding the specified heights.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Examples:</th><td class="field-body"><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">calc</span> <span class="o">=</span> <span class="n">rft1d</span><span class="o">.</span><span class="n">prob</span><span class="o">.</span><span class="n">RFTCalculator</span><span class="p">(</span><span class="s">&#39;T&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span> <span class="mi">101</span><span class="p">,</span> <span class="mf">15.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">calc</span><span class="o">.</span><span class="n">sf</span><span class="p">(</span><span class="mf">3.5</span><span class="p">)</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div></blockquote>
</div>
</div>
<div class="section" id="bonferroni-correction">
<h2>Bonferroni correction<a class="headerlink" href="#bonferroni-correction" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><dl class="method">
<dt id="rft1d.prob.p_bonferroni">
<code class="descclassname">prob.</code><code class="descname">p_bonferroni</code><span class="sig-paren">(</span><em>STAT</em>, <em>z</em>, <em>df</em>, <em>Q</em>, <em>n=1</em><span class="sig-paren">)</span><a class="headerlink" href="#rft1d.prob.p_bonferroni" title="Permalink to this definition">¶</a></dt>
<dd><p>Bonferroni correction.</p>
<p>When fields are very rough a Bonferroni correction might be less severe than
the RFT threshold. This function yields Bonferroni-corrected p values based
on the number of field nodes <em>Q</em>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><em>STAT</em> &#8212; test statistic (one of:  &#8220;Z&#8221;, &#8220;T&#8221;, &#8220;F&#8221;, &#8220;X2&#8221;, &#8220;T2&#8221;)</p>
<p><em>z</em> &#8212; field height</p>
<p><em>df</em> &#8212; degrees of freedom [df{interest} df{error}]</p>
<p><em>Q</em> &#8212; number of field nodes (used for Bonferroni comparison)</p>
<p><em>n</em> &#8212; number of test statistic fields in conjunction</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The probability of exceeding the specified height.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">rft1d</span><span class="o">.</span><span class="n">prob</span><span class="o">.</span><span class="n">p_bonferroni</span><span class="p">(</span><span class="s">&#39;Z&#39;</span><span class="p">,</span> <span class="mf">3.1</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="mi">101</span><span class="p">)</span> <span class="c">#yields 0.098</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div></blockquote>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="random.html" class="btn btn-neutral float-right" title="rft1d.random">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="geom.html" class="btn btn-neutral" title="rft1d.geom"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Todd Pataky.
    </p>
  </div>

  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.1.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>


