<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Data sample modeling &#8212; power1d 0.1 documentation</title>
    
    <link rel="stylesheet" href="../_static/pyramid.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Power analysis" href="PowerAnalysis.html" />
    <link rel="prev" title="Examples" href="../Examples.html" />
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Neuton&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Nobile:regular,italic,bold,bolditalic&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<!--[if lte IE 6]>
<link rel="stylesheet" href="../_static/ie6.css" type="text/css" media="screen" charset="utf-8" />
<![endif]-->

  </head>
  <body role="document">
<div class="header" role="banner">
  <div class="logo">
    <a href="../index.html">
      <img class="logo" src="../_static/logo.png" border="0" alt="Logo"/>
    </a>
  </div>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="PowerAnalysis.html" title="Power analysis"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../Examples.html" title="Examples"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">power1d 0.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../Examples.html" accesskey="U">Examples</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="data-sample-modeling">
<span id="label-examples-datasample"></span><h1>Data sample modeling<a class="headerlink" href="#data-sample-modeling" title="Permalink to this headline">Â¶</a></h1>
<p>Consider the Canadian temperature dataset in the figure below; these data are from
<a class="reference internal" href="../References.html#label-literature"><span class="std std-ref">Ramsay &amp; Silverman (2005)</span></a>.
and are available for download here:</p>
<div class="line-block">
<div class="line"><a class="reference external" href="http://www.psych.mcgill.ca/misc/fda/downloads/FDAfuns/Matlab/">http://www.psych.mcgill.ca/misc/fda/downloads/FDAfuns/Matlab/</a></div>
<div class="line">In the <strong>fdaMatlab.zip</strong> file and in its <strong>/examples/weather</strong> folder.</div>
</div>
<p id="label-weatherdata">(<a class="reference external" href="../Examples/DataSample-1.py">Source code</a>, <a class="reference external" href="../Examples/DataSample-1.png">png</a>, <a class="reference external" href="../Examples/DataSample-1.hires.png">hires.png</a>, <a class="reference external" href="../Examples/DataSample-1.pdf">pdf</a>)</p>
<div class="figure">
<img alt="../_images/DataSample-1.png" src="../_images/DataSample-1.png" />
</div>
<p>The goal here is to create a model of these data that we can use to generate random
data samples. Those random samples will then be generated iteratively over a large number
of numerical experiments in order to build up probability distributions regarding our model.
Those probability distributions will ultimately be used to make probabilistic inferences
regarding our model.</p>
<p>There are four steps to creating a model:</p>
<ol class="arabic simple">
<li>Create baseline geometry.</li>
<li>Create signal geometry.</li>
<li>Create a noise model.</li>
<li>Combine 1&#8211;3 in a DataSample model.</li>
</ol>
<p>The first step in data-sample modeling in <strong>power1d</strong> is to create &#8220;baseline&#8221;
one-dimensional (1D) geometry. If one has experimental data like those depicted above,
it is easy to generate that baseline as a <strong>power1d.geom.Continuum1D</strong> as follows:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">power1d</span>

<span class="n">data</span>     <span class="o">=</span> <span class="n">power1d</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">weather</span><span class="p">()</span>  <span class="c1"># load data</span>
<span class="n">y</span>        <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Continental&#39;</span><span class="p">]</span>     <span class="c1"># extract one region</span>
<span class="n">m</span>        <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span> <span class="p">)</span>        <span class="c1"># mean continuum</span>

<span class="n">baseline</span> <span class="o">=</span> <span class="n">power1d</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">Continuum1D</span><span class="p">(</span> <span class="n">m</span> <span class="p">)</span>
<span class="n">baseline</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../Examples/DataSample-2.py">Source code</a>, <a class="reference external" href="../Examples/DataSample-2.png">png</a>, <a class="reference external" href="../Examples/DataSample-2.hires.png">hires.png</a>, <a class="reference external" href="../Examples/DataSample-2.pdf">pdf</a>)</p>
<div class="figure">
<img alt="../_images/DataSample-2.png" src="../_images/DataSample-2.png" />
</div>
<p>If we didn&#8217;t have experimental data we could approximate the baseline using the
geometric models in <a class="reference internal" href="../API/geom.html#label-api-geom"><span class="std std-ref">power1d.geom</span></a>. In this case one possibility for
modeling the baseline is to subtract a Constant value from a GaussianPulse
as indicated below.  This appears to create a reasonable approximation to
the experimental data.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span>
<span class="kn">import</span> <span class="nn">power1d</span>

<span class="n">data</span>     <span class="o">=</span> <span class="n">power1d</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">weather</span><span class="p">()</span>  <span class="c1"># load data</span>
<span class="n">y</span>        <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Continental&#39;</span><span class="p">]</span>     <span class="c1"># extract one region</span>
<span class="n">m</span>        <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span> <span class="p">)</span>        <span class="c1"># mean continuum</span>

<span class="c1"># approximate the experimental value using a Gaussian pulse:</span>
<span class="n">Q</span>        <span class="o">=</span> <span class="mi">365</span>  <span class="c1"># continuum size</span>
<span class="n">g0</span>       <span class="o">=</span> <span class="n">power1d</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">GaussianPulse</span><span class="p">(</span> <span class="n">Q</span> <span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mi">200</span> <span class="p">,</span> <span class="n">fwhm</span><span class="o">=</span><span class="mi">190</span> <span class="p">,</span> <span class="n">amp</span><span class="o">=</span><span class="mi">40</span> <span class="p">)</span>
<span class="n">g1</span>       <span class="o">=</span> <span class="n">power1d</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">Constant</span><span class="p">(</span> <span class="n">Q</span> <span class="p">,</span> <span class="n">amp</span><span class="o">=</span><span class="mi">23</span> <span class="p">)</span>
<span class="n">baseline</span> <span class="o">=</span> <span class="n">g0</span> <span class="o">-</span> <span class="n">g1</span>  <span class="c1"># subtract the geometries</span>

<span class="n">ax</span>       <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">axes</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">m</span> <span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Experimental mean&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">baseline</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Model&#39;</span> <span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../Examples/DataSample-3.py">Source code</a>, <a class="reference external" href="../Examples/DataSample-3.png">png</a>, <a class="reference external" href="../Examples/DataSample-3.hires.png">hires.png</a>, <a class="reference external" href="../Examples/DataSample-3.pdf">pdf</a>)</p>
<div class="figure">
<img alt="../_images/DataSample-3.png" src="../_images/DataSample-3.png" />
</div>
<p>The second step is to create a signal that we wish to detect experimentally.
Let&#8217;s say that we hope to detect a broad increase in temperature over the
summer months with a maximum temperature increase of 5 deg. That could be
modeled as a second Gaussian pulse like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span>
<span class="kn">import</span> <span class="nn">power1d</span>

<span class="n">data</span>     <span class="o">=</span> <span class="n">power1d</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">weather</span><span class="p">()</span>  <span class="c1"># load data</span>
<span class="n">y</span>        <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Continental&#39;</span><span class="p">]</span>     <span class="c1"># extract one region</span>
<span class="n">m</span>        <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span> <span class="p">)</span>        <span class="c1"># mean continuum</span>

<span class="c1"># approximate the experimental value using a Gaussian pulse:</span>
<span class="n">Q</span>        <span class="o">=</span> <span class="mi">365</span>  <span class="c1"># continuum size</span>
<span class="n">g0</span>       <span class="o">=</span> <span class="n">power1d</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">GaussianPulse</span><span class="p">(</span> <span class="n">Q</span> <span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mi">200</span> <span class="p">,</span> <span class="n">fwhm</span><span class="o">=</span><span class="mi">190</span> <span class="p">,</span> <span class="n">amp</span><span class="o">=</span><span class="mi">40</span> <span class="p">)</span>
<span class="n">g1</span>       <span class="o">=</span> <span class="n">power1d</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">Constant</span><span class="p">(</span> <span class="n">Q</span> <span class="p">,</span> <span class="n">amp</span><span class="o">=</span><span class="mi">23</span> <span class="p">)</span>
<span class="n">baseline</span> <span class="o">=</span> <span class="n">g0</span> <span class="o">-</span> <span class="n">g1</span>  <span class="c1"># subtract the geometries</span>

<span class="c1"># add a signal:</span>
<span class="n">signal</span>   <span class="o">=</span> <span class="n">power1d</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">GaussianPulse</span><span class="p">(</span> <span class="n">Q</span> <span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mi">200</span> <span class="p">,</span> <span class="n">fwhm</span><span class="o">=</span><span class="mi">100</span> <span class="p">,</span> <span class="n">amp</span><span class="o">=</span><span class="mi">5</span> <span class="p">)</span>

<span class="n">ax</span>       <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">axes</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">m</span> <span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Experimental mean&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">baseline</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Model&#39;</span> <span class="p">)</span>
<span class="p">(</span><span class="n">baseline</span> <span class="o">+</span> <span class="n">signal</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Signal&#39;</span> <span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../Examples/DataSample-4.py">Source code</a>, <a class="reference external" href="../Examples/DataSample-4.png">png</a>, <a class="reference external" href="../Examples/DataSample-4.hires.png">hires.png</a>, <a class="reference external" href="../Examples/DataSample-4.pdf">pdf</a>)</p>
<div class="figure">
<img alt="../_images/DataSample-4.png" src="../_images/DataSample-4.png" />
</div>
<p>The third step is to create a model of the noise we expect to observe
experimentally.  From the <a class="reference internal" href="#label-weatherdata"><span class="std std-ref">weather data</span></a> above
we can see at least two types of noise: a high-frequency day-to-day noise
and lower-frequency noise across the different 1D observations. In
<strong>power1d</strong> a variety of <a class="reference internal" href="../API/noise.html#label-api-noise"><span class="std std-ref">noise models</span></a> are available
to model theses processes. Here let&#8217;s model the noise as a combination
of uncorrelated Gaussian noise and SmoothGaussian noise:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span>
<span class="kn">import</span> <span class="nn">power1d</span>

<span class="n">J</span>        <span class="o">=</span> <span class="mi">8</span>    <span class="c1"># sample size</span>
<span class="n">Q</span>        <span class="o">=</span> <span class="mi">365</span>  <span class="c1"># continuum size</span>
<span class="n">noise0</span>   <span class="o">=</span> <span class="n">power1d</span><span class="o">.</span><span class="n">noise</span><span class="o">.</span><span class="n">Gaussian</span><span class="p">(</span> <span class="n">J</span> <span class="p">,</span> <span class="n">Q</span> <span class="p">,</span> <span class="n">mu</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="mf">0.3</span> <span class="p">)</span>
<span class="n">noise1</span>   <span class="o">=</span> <span class="n">power1d</span><span class="o">.</span><span class="n">noise</span><span class="o">.</span><span class="n">SmoothGaussian</span><span class="p">(</span> <span class="n">J</span> <span class="p">,</span> <span class="n">Q</span> <span class="p">,</span> <span class="n">mu</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="mi">3</span> <span class="p">,</span> <span class="n">fwhm</span> <span class="o">=</span> <span class="mi">70</span> <span class="p">)</span>
<span class="n">noise</span>    <span class="o">=</span> <span class="n">power1d</span><span class="o">.</span><span class="n">noise</span><span class="o">.</span><span class="n">Additive</span><span class="p">(</span> <span class="n">noise0</span> <span class="p">,</span> <span class="n">noise1</span> <span class="p">)</span>

<span class="n">ax0</span>      <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">221</span><span class="p">)</span>
<span class="n">ax1</span>      <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">222</span><span class="p">)</span>
<span class="n">ax2</span>      <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">223</span><span class="p">)</span>
<span class="n">AX</span>       <span class="o">=</span> <span class="p">[</span><span class="n">ax0</span><span class="p">,</span> <span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">]</span>

<span class="c1"># plot noise objects:</span>
<span class="n">noise0</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax0</span> <span class="p">)</span>
<span class="n">noise1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span> <span class="p">)</span>
<span class="n">noise</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span> <span class="p">)</span>
<span class="n">pyplot</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">AX</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>

<span class="c1"># add panel labels:</span>
<span class="n">labels</span>   <span class="o">=</span> <span class="s1">&#39;Gaussian&#39;</span><span class="p">,</span> <span class="s1">&#39;SmoothGaussian&#39;</span><span class="p">,</span> <span class="s1">&#39;Additive&#39;</span>
<span class="k">for</span> <span class="n">ax</span><span class="p">,</span><span class="n">s</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span> <span class="n">AX</span> <span class="p">,</span> <span class="n">labels</span> <span class="p">):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../Examples/DataSample-5.py">Source code</a>, <a class="reference external" href="../Examples/DataSample-5.png">png</a>, <a class="reference external" href="../Examples/DataSample-5.hires.png">hires.png</a>, <a class="reference external" href="../Examples/DataSample-5.pdf">pdf</a>)</p>
<div class="figure">
<img alt="../_images/DataSample-5.png" src="../_images/DataSample-5.png" />
</div>
<p>Before we add that noise to our model let&#8217;s consider these noise models briefly.
Each noise model has an attribute <em>value</em> which contains a  (J x Q) array
representing the current state of the random noise. New random noise can
be generated using the <em>random</em> method, and the noise values can be replicated
using NumPy&#8217;s <strong>np.random.seed</strong> function as follows:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span>
<span class="kn">import</span> <span class="nn">power1d</span>

<span class="n">J</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">Q</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">ax0</span>      <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">221</span><span class="p">)</span>
<span class="n">ax1</span>      <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">222</span><span class="p">)</span>
<span class="n">ax2</span>      <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">223</span><span class="p">)</span>
<span class="n">AX</span>       <span class="o">=</span> <span class="p">[</span><span class="n">ax0</span><span class="p">,</span> <span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">]</span>

<span class="c1"># (a) generate noise object:</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">12345</span><span class="p">)</span>
<span class="n">noise</span>    <span class="o">=</span> <span class="n">power1d</span><span class="o">.</span><span class="n">noise</span><span class="o">.</span><span class="n">Gaussian</span><span class="p">(</span><span class="n">J</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">noise</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax0</span> <span class="p">)</span>

<span class="c1"># (b) create new random data:</span>
<span class="n">noise</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
<span class="n">noise</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span> <span class="p">)</span>

<span class="c1"># (c) reset noise to its original state:</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">12345</span><span class="p">)</span>
<span class="n">noise</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
<span class="n">noise</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span> <span class="p">)</span>

<span class="c1"># add panel labels:</span>
<span class="n">labels</span>   <span class="o">=</span> <span class="s1">&#39;(a)  Original noise&#39;</span><span class="p">,</span> <span class="s1">&#39;(b)  New noise&#39;</span><span class="p">,</span> <span class="s1">&#39;(c)  Reset using np.random.seed&#39;</span>
<span class="k">for</span> <span class="n">ax</span><span class="p">,</span><span class="n">s</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span> <span class="n">AX</span> <span class="p">,</span> <span class="n">labels</span> <span class="p">):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../Examples/DataSample-6.py">Source code</a>, <a class="reference external" href="../Examples/DataSample-6.png">png</a>, <a class="reference external" href="../Examples/DataSample-6.hires.png">hires.png</a>, <a class="reference external" href="../Examples/DataSample-6.pdf">pdf</a>)</p>
<div class="figure">
<img alt="../_images/DataSample-6.png" src="../_images/DataSample-6.png" />
</div>
<p>This noise control is identical for all types of <a class="reference internal" href="../API/noise.html#label-api-noise"><span class="std std-ref">noise models</span></a>
including compound types like the Additive model above.</p>
<p>The fourth and final step is to combine our baseline, signal and noise objects
into a DataSample object like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span>
<span class="kn">import</span> <span class="nn">power1d</span>

<span class="n">J</span>        <span class="o">=</span> <span class="mi">8</span>    <span class="c1"># sample size</span>
<span class="n">Q</span>        <span class="o">=</span> <span class="mi">365</span>  <span class="c1"># continuum size</span>

<span class="c1"># construct baseline geometry:</span>
<span class="n">g0</span>       <span class="o">=</span> <span class="n">power1d</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">GaussianPulse</span><span class="p">(</span> <span class="n">Q</span> <span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mi">200</span> <span class="p">,</span> <span class="n">fwhm</span><span class="o">=</span><span class="mi">190</span> <span class="p">,</span> <span class="n">amp</span><span class="o">=</span><span class="mi">40</span> <span class="p">)</span>
<span class="n">g1</span>       <span class="o">=</span> <span class="n">power1d</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">Constant</span><span class="p">(</span> <span class="n">Q</span> <span class="p">,</span> <span class="n">amp</span><span class="o">=</span><span class="mi">23</span> <span class="p">)</span>
<span class="n">baseline</span> <span class="o">=</span> <span class="n">g0</span> <span class="o">-</span> <span class="n">g1</span>  <span class="c1"># subtract the geometries</span>

<span class="c1"># construct signal geometry:</span>
<span class="n">signal</span>   <span class="o">=</span> <span class="n">power1d</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">GaussianPulse</span><span class="p">(</span> <span class="n">Q</span> <span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mi">200</span> <span class="p">,</span> <span class="n">fwhm</span><span class="o">=</span><span class="mi">100</span> <span class="p">,</span> <span class="n">amp</span><span class="o">=</span><span class="mi">5</span> <span class="p">)</span>

<span class="c1"># construct noise model:</span>
<span class="n">noise0</span>   <span class="o">=</span> <span class="n">power1d</span><span class="o">.</span><span class="n">noise</span><span class="o">.</span><span class="n">Gaussian</span><span class="p">(</span> <span class="n">J</span> <span class="p">,</span> <span class="n">Q</span> <span class="p">,</span> <span class="n">mu</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="mf">0.3</span> <span class="p">)</span>
<span class="n">noise1</span>   <span class="o">=</span> <span class="n">power1d</span><span class="o">.</span><span class="n">noise</span><span class="o">.</span><span class="n">SmoothGaussian</span><span class="p">(</span> <span class="n">J</span> <span class="p">,</span> <span class="n">Q</span> <span class="p">,</span> <span class="n">mu</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="mi">3</span> <span class="p">,</span> <span class="n">fwhm</span> <span class="o">=</span> <span class="mi">70</span> <span class="p">)</span>
<span class="n">noise</span>    <span class="o">=</span> <span class="n">power1d</span><span class="o">.</span><span class="n">noise</span><span class="o">.</span><span class="n">Additive</span><span class="p">(</span> <span class="n">noise0</span> <span class="p">,</span> <span class="n">noise1</span> <span class="p">)</span>

<span class="c1"># create data sample model:</span>
<span class="n">model</span>    <span class="o">=</span> <span class="n">power1d</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">DataSample</span><span class="p">(</span> <span class="n">baseline</span><span class="p">,</span> <span class="n">signal</span><span class="p">,</span> <span class="n">noise</span><span class="p">,</span> <span class="n">J</span><span class="o">=</span><span class="n">J</span> <span class="p">)</span>

<span class="c1"># visualize</span>
<span class="n">ax0</span>      <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">221</span><span class="p">)</span>
<span class="n">ax1</span>      <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">222</span><span class="p">)</span>
<span class="n">ax2</span>      <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">223</span><span class="p">)</span>
<span class="n">AX</span>       <span class="o">=</span> <span class="p">[</span><span class="n">ax0</span><span class="p">,</span> <span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">]</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">12345</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax0</span> <span class="p">)</span>

<span class="n">model</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span> <span class="p">)</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">12345</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span> <span class="p">)</span>

<span class="n">pyplot</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">AX</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="mi">40</span><span class="p">))</span>

<span class="c1"># add panel labels:</span>
<span class="n">labels</span>   <span class="o">=</span> <span class="s1">&#39;(a)  Original model state&#39;</span><span class="p">,</span> <span class="s1">&#39;(b)  New state&#39;</span><span class="p">,</span> <span class="s1">&#39;(c)  Reset using np.random.seed&#39;</span>
<span class="k">for</span> <span class="n">ax</span><span class="p">,</span><span class="n">s</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span> <span class="n">AX</span> <span class="p">,</span> <span class="n">labels</span> <span class="p">):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../Examples/DataSample-7.py">Source code</a>, <a class="reference external" href="../Examples/DataSample-7.png">png</a>, <a class="reference external" href="../Examples/DataSample-7.hires.png">hires.png</a>, <a class="reference external" href="../Examples/DataSample-7.pdf">pdf</a>)</p>
<div class="figure">
<img alt="../_images/DataSample-7.png" src="../_images/DataSample-7.png" />
</div>
<p>In the figure above we see that, like the noise models, we can generate new data sample
models using the <em>random</em> method and we can control the model&#8217;s random state using
<strong>np.random.seed</strong>.</p>
<p>This instantaneous state of a DataModel represents the type of data we expect to observe
in a single experiment <strong>if</strong> the baseline, signal and noise models are all accurate.
If they are accurate we can numerically generate a large number of experimental datasets
as if we had conducted a large number of experiments. Moreover, and most importantly,
we can compare one model to another. Specifically, by comparing a model with no (or Null)
signal to one with a modeled (non-null) signal we can calculate the power with which
we will be able to detect that signal given our noise model.</p>
<p>This type of power analyis is described in <a class="reference internal" href="PowerAnalysis.html#label-examples-poweranalysis"><span class="std std-ref">the next section</span></a>.</p>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="../Examples.html"
                        title="previous chapter">Examples</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="PowerAnalysis.html"
                        title="next chapter">Power analysis</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="PowerAnalysis.html" title="Power analysis"
             >next</a> |</li>
        <li class="right" >
          <a href="../Examples.html" title="Examples"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">power1d 0.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../Examples.html" >Examples</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, Todd Pataky.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.1.
    </div>
  </body>
</html>