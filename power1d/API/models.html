
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>power1d.models &#8212; power1d 0.1.7 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/pyramid.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="power1d.noise" href="noise.html" />
    <link rel="prev" title="power1d.io" href="io.html" />
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Neuton&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Nobile:regular,italic,bold,bolditalic&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<!--[if lte IE 6]>
<link rel="stylesheet" href="../_static/ie6.css" type="text/css" media="screen" charset="utf-8" />
<![endif]-->

  </head><body>
<div class="header" role="banner">
  <div class="logo">
    <a href="../index.html">
      <img class="logo" src="../_static/logo.png" border="0" alt="Logo"/>
    </a>
  </div>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="noise.html" title="power1d.noise"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="io.html" title="power1d.io"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">power1d 0.1.7 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../API.html" accesskey="U">API</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">power1d.models</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="module-power1d.models">
<span id="power1d-models"></span><span id="label-api-models"></span><h1>power1d.models<a class="headerlink" href="#module-power1d.models" title="Permalink to this heading">¶</a></h1>
<p>High-level classes for assembling data models and simulating experiments.</p>
<p>Below attributes and methods can be distinguished as follows:</p>
<ul class="simple">
<li><p>attribute names are followed by “= None”</p></li>
<li><p>method names are followed by “( )” with arguments inside the parentheses, and all methods also have code snippets attached.</p></li>
</ul>
<section id="datasample-from-array">
<span id="label-api-models-datasample-from-array"></span><h2>datasample_from_array<a class="headerlink" href="#datasample-from-array" title="Permalink to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="power1d.models.datasample_from_array">
<span class="sig-prename descclassname"><span class="pre">power1d.models.</span></span><span class="sig-name descname"><span class="pre">datasample_from_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#power1d.models.datasample_from_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience function for creating a data sample from
a set of of 1D observations.</p>
<p>The input array must have a shape (J,Q) where:</p>
<blockquote>
<div><p>J = number of observations</p>
<p>Q = number of continuum nodes</p>
</div></blockquote>
<p>WARNING! “datasample_from_array” uses a relatively simple
SmoothGaussian noise model, and this may NOT embody all
features of real, experimental noise. In this case more
complex noise modeling (e.g. Additive, Mixture) may
be required. Refer to the noise module for more details.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">power1d</span>

<span class="n">y</span>        <span class="o">=</span> <span class="n">power1d</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">weather</span><span class="p">()[</span><span class="s1">&#39;Atlantic&#39;</span><span class="p">]</span>
<span class="n">model</span>    <span class="o">=</span> <span class="n">power1d</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">datasample_from_array</span><span class="p">(</span> <span class="n">y</span> <span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span><span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">y</span><span class="o">.</span><span class="n">T</span> <span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">model</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="p">)</span>
<span class="n">labels</span>  <span class="o">=</span> <span class="s1">&#39;Original data&#39;</span><span class="p">,</span> <span class="s1">&#39;DataSample model&#39;</span><span class="p">,</span> <span class="s1">&#39;DataSample model (new noise)&#39;</span>
<span class="p">[</span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">ax</span><span class="p">,</span><span class="n">s</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axs</span><span class="p">,</span><span class="n">labels</span><span class="p">)]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../API/models-1.py">Source code</a>, <a class="reference external" href="../API/models-1.png">png</a>, <a class="reference external" href="../API/models-1.hires.png">hires.png</a>, <a class="reference external" href="../API/models-1.pdf">pdf</a>)</p>
<figure class="align-default">
<img alt="../_images/models-1.png" class="plot-directive" src="../_images/models-1.png" />
</figure>
</dd></dl>

</section>
<section id="datasample">
<h2>DataSample<a class="headerlink" href="#datasample" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="power1d.models.DataSample">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">power1d.models.</span></span><span class="sig-name descname"><span class="pre">DataSample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">baseline</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">J</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regressor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#power1d.models.DataSample" title="Permalink to this definition">¶</a></dt>
<dd><p>Data Sample model.</p>
<p>Arguments:</p>
<p><em>baseline</em> —- a power1d.geom object representing the sample datum</p>
<p><em>signal</em> —- a power1d.geom object representing the sample signal</p>
<p><em>noise</em> —- a power1d.noise object representing the sample noise</p>
<p><em>J</em> —- sample size (int, default 8)</p>
<p><em>regressor</em> —- an optional regressor that will scale the signal across the <em>J</em> observations (length-J numpy array)</p>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">power1d</span>

<span class="n">J</span>        <span class="o">=</span> <span class="mi">20</span>
<span class="n">Q</span>        <span class="o">=</span> <span class="mi">101</span>
<span class="n">baseline</span> <span class="o">=</span> <span class="n">power1d</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">Null</span><span class="p">(</span> <span class="n">Q</span><span class="o">=</span><span class="n">Q</span> <span class="p">)</span>
<span class="n">signal</span>   <span class="o">=</span> <span class="n">power1d</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">GaussianPulse</span><span class="p">(</span> <span class="n">Q</span><span class="o">=</span><span class="n">Q</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">fwhm</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">amp</span><span class="o">=</span><span class="mf">3.5</span> <span class="p">)</span>
<span class="n">noise</span>    <span class="o">=</span> <span class="n">power1d</span><span class="o">.</span><span class="n">noise</span><span class="o">.</span><span class="n">SmoothGaussian</span><span class="p">(</span> <span class="n">J</span><span class="o">=</span><span class="n">J</span><span class="p">,</span> <span class="n">Q</span><span class="o">=</span><span class="n">Q</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">fwhm</span><span class="o">=</span><span class="mi">20</span> <span class="p">)</span>
<span class="n">model</span>    <span class="o">=</span> <span class="n">power1d</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">DataSample</span><span class="p">(</span><span class="n">baseline</span><span class="p">,</span> <span class="n">signal</span><span class="p">,</span> <span class="n">noise</span><span class="p">,</span> <span class="n">J</span><span class="o">=</span><span class="n">J</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;g&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../API/models-2.py">Source code</a>, <a class="reference external" href="../API/models-2.png">png</a>, <a class="reference external" href="../API/models-2.hires.png">hires.png</a>, <a class="reference external" href="../API/models-2.pdf">pdf</a>)</p>
<figure class="align-default">
<img alt="../_images/models-2.png" class="plot-directive" src="../_images/models-2.png" />
</figure>
<dl class="py attribute">
<dt class="sig sig-object py" id="power1d.models.DataSample.J">
<span class="sig-name descname"><span class="pre">J</span></span><a class="headerlink" href="#power1d.models.DataSample.J" title="Permalink to this definition">¶</a></dt>
<dd><p>sample size</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="power1d.models.DataSample.Q">
<span class="sig-name descname"><span class="pre">Q</span></span><a class="headerlink" href="#power1d.models.DataSample.Q" title="Permalink to this definition">¶</a></dt>
<dd><p>continuum size</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="power1d.models.DataSample.baseline">
<span class="sig-name descname"><span class="pre">baseline</span></span><a class="headerlink" href="#power1d.models.DataSample.baseline" title="Permalink to this definition">¶</a></dt>
<dd><p>baseline model</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="power1d.models.DataSample.get_baseline">
<span class="sig-name descname"><span class="pre">get_baseline</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#power1d.models.DataSample.get_baseline" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the DataSample’s baseline object</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="power1d.models.DataSample.get_noise">
<span class="sig-name descname"><span class="pre">get_noise</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#power1d.models.DataSample.get_noise" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the DataSample’s noise object</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="power1d.models.DataSample.get_signal">
<span class="sig-name descname"><span class="pre">get_signal</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#power1d.models.DataSample.get_signal" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the DataSample’s signal object</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="power1d.models.DataSample.link">
<span class="sig-name descname"><span class="pre">link</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#power1d.models.DataSample.link" title="Permalink to this definition">¶</a></dt>
<dd><p>Link noise to another DataSample object so that the linked object’s
noise is equivalent to master object’s noise.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="power1d.models.DataSample.noise">
<span class="sig-name descname"><span class="pre">noise</span></span><a class="headerlink" href="#power1d.models.DataSample.noise" title="Permalink to this definition">¶</a></dt>
<dd><p>noise model</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="power1d.models.DataSample.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_noise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'k'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#power1d.models.DataSample.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot an instantaneous representation of the DataSample</p>
<p>Arguments:</p>
<p><em>ax</em> —- pyplot axes object (default None)</p>
<p><em>with_noise</em> —- whether or not to plot the noise (bool, default True)</p>
<p><em>color</em> —- a matplotlib color for all lines (baseline, signal and noise) (default “k” – black)</p>
<p><em>lw</em> —- linewidth for the signal (int, default 3)</p>
<p><em>q</em> —- optional continuum position values (length-Q array of monotonically increasing values) (default None)</p>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">power1d</span>

<span class="n">J</span>        <span class="o">=</span> <span class="mi">8</span>
<span class="n">Q</span>        <span class="o">=</span> <span class="mi">101</span>
<span class="n">baseline</span> <span class="o">=</span> <span class="n">power1d</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">Null</span><span class="p">(</span> <span class="n">Q</span><span class="o">=</span><span class="n">Q</span> <span class="p">)</span>
<span class="n">signal</span>   <span class="o">=</span> <span class="n">power1d</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">GaussianPulse</span><span class="p">(</span> <span class="n">Q</span><span class="o">=</span><span class="n">Q</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mi">75</span><span class="p">,</span> <span class="n">fwhm</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">amp</span><span class="o">=</span><span class="mf">5.0</span> <span class="p">)</span>
<span class="n">noise</span>    <span class="o">=</span> <span class="n">power1d</span><span class="o">.</span><span class="n">noise</span><span class="o">.</span><span class="n">Gaussian</span><span class="p">(</span> <span class="n">J</span><span class="o">=</span><span class="n">J</span><span class="p">,</span> <span class="n">Q</span><span class="o">=</span><span class="n">Q</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">1.0</span> <span class="p">)</span>
<span class="n">model</span>    <span class="o">=</span> <span class="n">power1d</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">DataSample</span><span class="p">(</span><span class="n">baseline</span><span class="p">,</span> <span class="n">signal</span><span class="p">,</span> <span class="n">noise</span><span class="p">,</span> <span class="n">J</span><span class="o">=</span><span class="n">J</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../API/models-3.py">Source code</a>, <a class="reference external" href="../API/models-3.png">png</a>, <a class="reference external" href="../API/models-3.hires.png">hires.png</a>, <a class="reference external" href="../API/models-3.pdf">pdf</a>)</p>
<figure class="align-default">
<img alt="../_images/models-3.png" class="plot-directive" src="../_images/models-3.png" />
</figure>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="power1d.models.DataSample.random">
<span class="sig-name descname"><span class="pre">random</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">subtract_baseline</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#power1d.models.DataSample.random" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a random data sample based on the baseline, signal and noise models.
The value will be stored in the “value” attribute.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="power1d.models.DataSample.regressor">
<span class="sig-name descname"><span class="pre">regressor</span></span><a class="headerlink" href="#power1d.models.DataSample.regressor" title="Permalink to this definition">¶</a></dt>
<dd><p>(J,) numpy array representing regressor</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="power1d.models.DataSample.set_baseline">
<span class="sig-name descname"><span class="pre">set_baseline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">baseline</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#power1d.models.DataSample.set_baseline" title="Permalink to this definition">¶</a></dt>
<dd><p>Change the DataSample’s baseline object</p>
<p>Arguments:</p>
<p><em>baseline</em> —- a power1d.geom object representing the sample datum</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="power1d.models.DataSample.set_noise">
<span class="sig-name descname"><span class="pre">set_noise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">noise</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#power1d.models.DataSample.set_noise" title="Permalink to this definition">¶</a></dt>
<dd><p>Change the DataSample’s baseline object</p>
<p>Arguments:</p>
<p><em>baseline</em> —- a power1d.noise object representing the sample datum</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="power1d.models.DataSample.set_regressor">
<span class="sig-name descname"><span class="pre">set_regressor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#power1d.models.DataSample.set_regressor" title="Permalink to this definition">¶</a></dt>
<dd><p>Set or change the DataSample’s regressor</p>
<p>Arguments:</p>
<p><em>x</em> —- a length-J numpy array (float)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="power1d.models.DataSample.set_sample_size">
<span class="sig-name descname"><span class="pre">set_sample_size</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">J</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#power1d.models.DataSample.set_sample_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Change the sample size</p>
<p>Arguments:</p>
<p><em>J</em> —- sample size (positive int)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="power1d.models.DataSample.set_signal">
<span class="sig-name descname"><span class="pre">set_signal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">signal</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#power1d.models.DataSample.set_signal" title="Permalink to this definition">¶</a></dt>
<dd><p>Change the DataSample’s signal object</p>
<p>Arguments:</p>
<p><em>signal</em> —- a power1d.geom object representing the sample signal</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="power1d.models.DataSample.signal">
<span class="sig-name descname"><span class="pre">signal</span></span><a class="headerlink" href="#power1d.models.DataSample.signal" title="Permalink to this definition">¶</a></dt>
<dd><p>signal model</p>
</dd></dl>

</dd></dl>

</section>
<section id="experiment">
<h2>Experiment<a class="headerlink" href="#experiment" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="power1d.models.Experiment">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">power1d.models.</span></span><span class="sig-name descname"><span class="pre">Experiment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_sample_models</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fn</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#power1d.models.Experiment" title="Permalink to this definition">¶</a></dt>
<dd><p>Experiment model.</p>
<p>Arguments:</p>
<p><em>data_sample_models</em> —- a list of DataSample objects</p>
<p><em>fn</em> —- a function for computing the test statistic (must accept a sequence of (J,Q)
arrays and return a length-Q array representing the test statistic continuum). Standard
test statistic functions are available in <strong>power1d.stats</strong></p>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">power1d</span>

<span class="n">J</span>        <span class="o">=</span> <span class="mi">10</span>
<span class="n">Q</span>        <span class="o">=</span> <span class="mi">101</span>
<span class="n">baseline</span> <span class="o">=</span> <span class="n">power1d</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">Null</span><span class="p">(</span> <span class="n">Q</span><span class="o">=</span><span class="n">Q</span> <span class="p">)</span>
<span class="n">signal0</span>  <span class="o">=</span> <span class="n">power1d</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">Null</span><span class="p">(</span> <span class="n">Q</span><span class="o">=</span><span class="n">Q</span> <span class="p">)</span>
<span class="n">signal1</span>  <span class="o">=</span> <span class="n">power1d</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">GaussianPulse</span><span class="p">(</span> <span class="n">Q</span><span class="o">=</span><span class="n">Q</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">fwhm</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">amp</span><span class="o">=</span><span class="mf">3.5</span> <span class="p">)</span>
<span class="n">noise</span>    <span class="o">=</span> <span class="n">power1d</span><span class="o">.</span><span class="n">noise</span><span class="o">.</span><span class="n">Gaussian</span><span class="p">(</span> <span class="n">J</span><span class="o">=</span><span class="n">J</span><span class="p">,</span> <span class="n">Q</span><span class="o">=</span><span class="n">Q</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">1.0</span> <span class="p">)</span>
<span class="n">model0</span>   <span class="o">=</span> <span class="n">power1d</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">DataSample</span><span class="p">(</span><span class="n">baseline</span><span class="p">,</span> <span class="n">signal0</span><span class="p">,</span> <span class="n">noise</span><span class="p">,</span> <span class="n">J</span><span class="o">=</span><span class="n">J</span><span class="p">)</span>
<span class="n">model1</span>   <span class="o">=</span> <span class="n">power1d</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">DataSample</span><span class="p">(</span><span class="n">baseline</span><span class="p">,</span> <span class="n">signal1</span><span class="p">,</span> <span class="n">noise</span><span class="p">,</span> <span class="n">J</span><span class="o">=</span><span class="n">J</span><span class="p">)</span>
<span class="n">emodel</span>   <span class="o">=</span> <span class="n">power1d</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">Experiment</span><span class="p">(</span> <span class="p">[</span><span class="n">model0</span><span class="p">,</span> <span class="n">model1</span><span class="p">],</span> <span class="n">fn</span><span class="o">=</span><span class="n">power1d</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">t_2sample</span> <span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="n">emodel</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../API/models-4.py">Source code</a>, <a class="reference external" href="../API/models-4.png">png</a>, <a class="reference external" href="../API/models-4.hires.png">hires.png</a>, <a class="reference external" href="../API/models-4.pdf">pdf</a>)</p>
<figure class="align-default">
<img alt="../_images/models-4.png" class="plot-directive" src="../_images/models-4.png" />
</figure>
<dl class="py attribute">
<dt class="sig sig-object py" id="power1d.models.Experiment.Q">
<span class="sig-name descname"><span class="pre">Q</span></span><a class="headerlink" href="#power1d.models.Experiment.Q" title="Permalink to this definition">¶</a></dt>
<dd><p>continuum length</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="power1d.models.Experiment.Z">
<span class="sig-name descname"><span class="pre">Z</span></span><a class="headerlink" href="#power1d.models.Experiment.Z" title="Permalink to this definition">¶</a></dt>
<dd><p>output test statistic continua</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="power1d.models.Experiment.data_models">
<span class="sig-name descname"><span class="pre">data_models</span></span><a class="headerlink" href="#power1d.models.Experiment.data_models" title="Permalink to this definition">¶</a></dt>
<dd><p>data models</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="power1d.models.Experiment.fn">
<span class="sig-name descname"><span class="pre">fn</span></span><a class="headerlink" href="#power1d.models.Experiment.fn" title="Permalink to this definition">¶</a></dt>
<dd><p>test statistic function</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="power1d.models.Experiment.nmodels">
<span class="sig-name descname"><span class="pre">nmodels</span></span><a class="headerlink" href="#power1d.models.Experiment.nmodels" title="Permalink to this definition">¶</a></dt>
<dd><p>number of data models</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="power1d.models.Experiment.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_noise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#power1d.models.Experiment.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot an instantaneous representation of the Experiment model.</p>
<p>Arguments:</p>
<p><em>ax</em> —- pyplot axes object (default None)</p>
<p><em>with_noise</em> —- whether or not to plot the noise (bool, default True)</p>
<p><em>colors</em> —- an optional sequence of matplotlib colors, one for each DataSample (default None)</p>
<p><em>q</em> —- optional continuum position values (length-Q array of monotonically increasing values) (default None)</p>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">power1d</span>

<span class="n">J</span>        <span class="o">=</span> <span class="mi">8</span>
<span class="n">Q</span>        <span class="o">=</span> <span class="mi">101</span>
<span class="n">baseline</span> <span class="o">=</span> <span class="n">power1d</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">Null</span><span class="p">(</span> <span class="n">Q</span><span class="o">=</span><span class="n">Q</span> <span class="p">)</span>
<span class="n">signal0</span>  <span class="o">=</span> <span class="n">power1d</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">Null</span><span class="p">(</span> <span class="n">Q</span><span class="o">=</span><span class="n">Q</span> <span class="p">)</span>
<span class="n">signal1</span>  <span class="o">=</span> <span class="n">power1d</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">GaussianPulse</span><span class="p">(</span> <span class="n">Q</span><span class="o">=</span><span class="n">Q</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">fwhm</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">amp</span><span class="o">=</span><span class="mf">3.5</span> <span class="p">)</span>
<span class="n">noise</span>    <span class="o">=</span> <span class="n">power1d</span><span class="o">.</span><span class="n">noise</span><span class="o">.</span><span class="n">Gaussian</span><span class="p">(</span> <span class="n">J</span><span class="o">=</span><span class="n">J</span><span class="p">,</span> <span class="n">Q</span><span class="o">=</span><span class="n">Q</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">1.0</span> <span class="p">)</span>
<span class="n">model0</span>   <span class="o">=</span> <span class="n">power1d</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">DataSample</span><span class="p">(</span><span class="n">baseline</span><span class="p">,</span> <span class="n">signal0</span><span class="p">,</span> <span class="n">noise</span><span class="p">,</span> <span class="n">J</span><span class="o">=</span><span class="n">J</span><span class="p">)</span>
<span class="n">model1</span>   <span class="o">=</span> <span class="n">power1d</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">DataSample</span><span class="p">(</span><span class="n">baseline</span><span class="p">,</span> <span class="n">signal1</span><span class="p">,</span> <span class="n">noise</span><span class="p">,</span> <span class="n">J</span><span class="o">=</span><span class="n">J</span><span class="p">)</span>
<span class="n">emodel</span>   <span class="o">=</span> <span class="n">power1d</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">Experiment</span><span class="p">(</span> <span class="p">[</span><span class="n">model0</span><span class="p">,</span> <span class="n">model1</span><span class="p">],</span> <span class="n">fn</span><span class="o">=</span><span class="n">power1d</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">t_2sample</span> <span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="n">emodel</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">colors</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">),</span> <span class="n">q</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Q</span><span class="p">)</span> <span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../API/models-5.py">Source code</a>, <a class="reference external" href="../API/models-5.png">png</a>, <a class="reference external" href="../API/models-5.hires.png">hires.png</a>, <a class="reference external" href="../API/models-5.pdf">pdf</a>)</p>
<figure class="align-default">
<img alt="../_images/models-5.png" class="plot-directive" src="../_images/models-5.png" />
</figure>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="power1d.models.Experiment.set_sample_size">
<span class="sig-name descname"><span class="pre">set_sample_size</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">JJ</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#power1d.models.Experiment.set_sample_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Change the sample sizes of the models</p>
<p>Arguments:</p>
<p><em>J</em> —- sample size (positive int or list of positive int)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="power1d.models.Experiment.simulate">
<span class="sig-name descname"><span class="pre">simulate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iterations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">progress_bar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#power1d.models.Experiment.simulate" title="Permalink to this definition">¶</a></dt>
<dd><p>Iteratively simulate a number of experiments.</p>
<p>Calling this method will repeatedly call <strong>simulate_single_iteration</strong> and
will store the resulting continua in the <strong>Z</strong> attribute;  if 1000 iterations
are executed then <strong>Z</strong> will be a (1000,Q) array when simulation is complete.</p>
<p>Arguments:</p>
<p><em>iterations</em> —- number of iterations to perform (positive int, default 1000)</p>
<p><em>progress_bar</em> —- whether or not to display a progress bar in the terminal (bool, default True)</p>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">power1d</span>

<span class="n">J</span>        <span class="o">=</span> <span class="mi">8</span>
<span class="n">Q</span>        <span class="o">=</span> <span class="mi">101</span>
<span class="n">baseline</span> <span class="o">=</span> <span class="n">power1d</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">Null</span><span class="p">(</span> <span class="n">Q</span><span class="o">=</span><span class="n">Q</span> <span class="p">)</span>
<span class="n">signal0</span>  <span class="o">=</span> <span class="n">power1d</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">Null</span><span class="p">(</span> <span class="n">Q</span><span class="o">=</span><span class="n">Q</span> <span class="p">)</span>
<span class="n">signal1</span>  <span class="o">=</span> <span class="n">power1d</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">GaussianPulse</span><span class="p">(</span> <span class="n">Q</span><span class="o">=</span><span class="n">Q</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">fwhm</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">amp</span><span class="o">=</span><span class="mf">3.5</span> <span class="p">)</span>
<span class="n">noise</span>    <span class="o">=</span> <span class="n">power1d</span><span class="o">.</span><span class="n">noise</span><span class="o">.</span><span class="n">Gaussian</span><span class="p">(</span> <span class="n">J</span><span class="o">=</span><span class="n">J</span><span class="p">,</span> <span class="n">Q</span><span class="o">=</span><span class="n">Q</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">1.0</span> <span class="p">)</span>
<span class="n">model0</span>   <span class="o">=</span> <span class="n">power1d</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">DataSample</span><span class="p">(</span><span class="n">baseline</span><span class="p">,</span> <span class="n">signal0</span><span class="p">,</span> <span class="n">noise</span><span class="p">,</span> <span class="n">J</span><span class="o">=</span><span class="n">J</span><span class="p">)</span>
<span class="n">model1</span>   <span class="o">=</span> <span class="n">power1d</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">DataSample</span><span class="p">(</span><span class="n">baseline</span><span class="p">,</span> <span class="n">signal1</span><span class="p">,</span> <span class="n">noise</span><span class="p">,</span> <span class="n">J</span><span class="o">=</span><span class="n">J</span><span class="p">)</span>
<span class="n">emodel</span>   <span class="o">=</span> <span class="n">power1d</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">Experiment</span><span class="p">(</span> <span class="p">[</span><span class="n">model0</span><span class="p">,</span> <span class="n">model1</span><span class="p">],</span> <span class="n">fn</span><span class="o">=</span><span class="n">power1d</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">t_2sample</span> <span class="p">)</span>

<span class="n">emodel</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="n">iterations</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">progress_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">emodel</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span> <span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Test statistic continua&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../API/models-6.py">Source code</a>, <a class="reference external" href="../API/models-6.png">png</a>, <a class="reference external" href="../API/models-6.hires.png">hires.png</a>, <a class="reference external" href="../API/models-6.pdf">pdf</a>)</p>
<figure class="align-default">
<img alt="../_images/models-6.png" class="plot-directive" src="../_images/models-6.png" />
</figure>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="power1d.models.Experiment.simulate_single_iteration">
<span class="sig-name descname"><span class="pre">simulate_single_iteration</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#power1d.models.Experiment.simulate_single_iteration" title="Permalink to this definition">¶</a></dt>
<dd><p>Simulate a single experiment.</p>
<p>Calling this method will generate new data samples, one for each DataSample model,
and will then compute and return the test statistic continuum associated with
the new data samples.</p>
</dd></dl>

</dd></dl>

</section>
<section id="experimentsimulator">
<h2>ExperimentSimulator<a class="headerlink" href="#experimentsimulator" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="power1d.models.ExperimentSimulator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">power1d.models.</span></span><span class="sig-name descname"><span class="pre">ExperimentSimulator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#power1d.models.ExperimentSimulator" title="Permalink to this definition">¶</a></dt>
<dd><p>Two-experiment simulator.</p>
<p>This is a convenience class for simulating two experiments:</p>
<ul class="simple">
<li><p>“null” experiment:  represents the null hypothesis</p></li>
<li><p>“effect” experiment:  represents the alternative hypothesis</p></li>
</ul>
<p>Simulation results will all share the following characteristics:</p>
<ul class="simple">
<li><p>Alpha-based critical thresholds are be computed for the “null” experiment</p></li>
<li><p>Power calculations use those thresholds to conducted power analysis on the “effect” experiment.</p></li>
</ul>
<p>Arguments:</p>
<p><em>model0</em> —- the “null” experiment model (power1d.models.Experiment)
<em>model1</em> —- the “effect” experiment model (power1d.models.Experiment)</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the “null” and “effect” models are identical then power will be alpha (or numerically close to it) by definition.</p>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="power1d.models.ExperimentSimulator.Q">
<span class="sig-name descname"><span class="pre">Q</span></span><a class="headerlink" href="#power1d.models.ExperimentSimulator.Q" title="Permalink to this definition">¶</a></dt>
<dd><p>continuum size</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="power1d.models.ExperimentSimulator.load_simulation_results">
<span class="sig-name descname"><span class="pre">load_simulation_results</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#power1d.models.ExperimentSimulator.load_simulation_results" title="Permalink to this definition">¶</a></dt>
<dd><p>Load saved simulation results.</p>
<p>Arguments:</p>
<p><em>filename</em> —- full path to saved results file</p>
<p>Outputs:</p>
<p><em>results</em> —- a results object (power1d.results.SimulationResults)</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Simulating experiments with large sample sizes, complex               DataSample models and/or a large number of simulation iterations can            be computationally demanding. The <strong>load_simulation_results</strong> method            allows you to probe simulation results efficiently, by saving the               results to disk following simulation, then subsequently skipping the            “simulate” command. In the example below the commands between the               “###” flags should be commented after executing “simulate” once.</p>
</div>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">power1d</span>

<span class="n">J</span>        <span class="o">=</span> <span class="mi">8</span>
<span class="n">Q</span>        <span class="o">=</span> <span class="mi">101</span>
<span class="n">baseline</span> <span class="o">=</span> <span class="n">power1d</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">Null</span><span class="p">(</span> <span class="n">Q</span><span class="o">=</span><span class="n">Q</span> <span class="p">)</span>
<span class="n">signal0</span>  <span class="o">=</span> <span class="n">power1d</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">Null</span><span class="p">(</span> <span class="n">Q</span><span class="o">=</span><span class="n">Q</span> <span class="p">)</span>
<span class="n">signal1</span>  <span class="o">=</span> <span class="n">power1d</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">GaussianPulse</span><span class="p">(</span> <span class="n">Q</span><span class="o">=</span><span class="n">Q</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">fwhm</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">amp</span><span class="o">=</span><span class="mf">1.2</span> <span class="p">)</span>
<span class="n">noise</span>    <span class="o">=</span> <span class="n">power1d</span><span class="o">.</span><span class="n">noise</span><span class="o">.</span><span class="n">Gaussian</span><span class="p">(</span> <span class="n">J</span><span class="o">=</span><span class="n">J</span><span class="p">,</span> <span class="n">Q</span><span class="o">=</span><span class="n">Q</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">1.0</span> <span class="p">)</span>
<span class="n">model0</span>   <span class="o">=</span> <span class="n">power1d</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">DataSample</span><span class="p">(</span><span class="n">baseline</span><span class="p">,</span> <span class="n">signal0</span><span class="p">,</span> <span class="n">noise</span><span class="p">,</span> <span class="n">J</span><span class="o">=</span><span class="n">J</span><span class="p">)</span>
<span class="n">model1</span>   <span class="o">=</span> <span class="n">power1d</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">DataSample</span><span class="p">(</span><span class="n">baseline</span><span class="p">,</span> <span class="n">signal1</span><span class="p">,</span> <span class="n">noise</span><span class="p">,</span> <span class="n">J</span><span class="o">=</span><span class="n">J</span><span class="p">)</span>

<span class="n">emodel0</span>  <span class="o">=</span> <span class="n">power1d</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">Experiment</span><span class="p">(</span> <span class="p">[</span><span class="n">model0</span><span class="p">,</span> <span class="n">model0</span><span class="p">],</span> <span class="n">fn</span><span class="o">=</span><span class="n">power1d</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">t_2sample</span> <span class="p">)</span>
<span class="n">emodel1</span>  <span class="o">=</span> <span class="n">power1d</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">Experiment</span><span class="p">(</span> <span class="p">[</span><span class="n">model0</span><span class="p">,</span> <span class="n">model1</span><span class="p">],</span> <span class="n">fn</span><span class="o">=</span><span class="n">power1d</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">t_2sample</span> <span class="p">)</span>


<span class="c1">###  COMMANDS BELOW SHOULD BE COMMENTED AFTER EXECUTING ONCE</span>
<span class="n">sim</span>      <span class="o">=</span> <span class="n">power1d</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">ExperimentSimulator</span><span class="p">(</span><span class="n">emodel0</span><span class="p">,</span> <span class="n">emodel1</span><span class="p">)</span>
<span class="n">results</span>  <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="n">iterations</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">progress_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fname</span>    <span class="o">=</span> <span class="s2">&quot;/tmp/results.npz&quot;</span>
<span class="n">results</span><span class="o">.</span><span class="n">save</span><span class="p">(</span> <span class="n">fname</span> <span class="p">)</span>
<span class="c1">###  COMMENTS ABOVE SHOULD BE COMMENTED AFTER EXECUTING ONCE</span>

<span class="c1">#Then the results can be re-loaded:</span>
<span class="n">fname</span>         <span class="o">=</span> <span class="s2">&quot;/tmp/results.npz&quot;</span>
<span class="n">saved_results</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">load_simulation_results</span><span class="p">(</span> <span class="n">fname</span> <span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="n">saved_results</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../API/models-7.py">Source code</a>, <a class="reference external" href="../API/models-7.png">png</a>, <a class="reference external" href="../API/models-7.hires.png">hires.png</a>, <a class="reference external" href="../API/models-7.pdf">pdf</a>)</p>
<figure class="align-default">
<img alt="../_images/models-7.png" class="plot-directive" src="../_images/models-7.png" />
</figure>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="power1d.models.ExperimentSimulator.model0">
<span class="sig-name descname"><span class="pre">model0</span></span><a class="headerlink" href="#power1d.models.ExperimentSimulator.model0" title="Permalink to this definition">¶</a></dt>
<dd><p>“null” experiment model</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="power1d.models.ExperimentSimulator.model1">
<span class="sig-name descname"><span class="pre">model1</span></span><a class="headerlink" href="#power1d.models.ExperimentSimulator.model1" title="Permalink to this definition">¶</a></dt>
<dd><p>“effect” experiment model</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="power1d.models.ExperimentSimulator.sample_size">
<span class="sig-name descname"><span class="pre">sample_size</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">power</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">niter0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">niter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#power1d.models.ExperimentSimulator.sample_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimate sample size required to achieve a target power.</p>
<p>When <em>coi</em> is None the omnibus power is used.
When <em>coi</em> is a dictionary then the COI power is used, e.g. <code class="code docutils literal notranslate"><span class="pre">coi=dict(q=65,</span> <span class="pre">r=3)</span></code></p>
<p>Arguments:</p>
<p><em>power</em> —- target power (default: 0.8, range: [0,1])</p>
<p><em>alpha</em> —- Type I error rate (default: 0.05, range: [0,1])</p>
<p><em>niter0</em> —- Number of iterations for initial, approximate solution (default: 200, range: [200,])</p>
<p><em>niter</em> —- Number of iterations for final solution (default: 1000, range: [1000,])</p>
<p><em>coi</em> —- Center-of-interest (default: None;  either None or dict(q=q, r=r)  where q is the COI and r is its radius; e.g. coi=dict(q=65, r=3))</p>
<p>Outputs:</p>
<p>Dictionary containing:</p>
<p><em>nstar</em> —- estimated sample size required to achieve the target power</p>
<p><em>n</em> — array of sample sizes used for the final power calculation</p>
<p><em>p</em> — array of final power values</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="power1d.models.ExperimentSimulator.simulate">
<span class="sig-name descname"><span class="pre">simulate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iterations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">progress_bar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">two_tailed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#power1d.models.ExperimentSimulator.simulate" title="Permalink to this definition">¶</a></dt>
<dd><p>Iteratively simulate a number of experiments.</p>
<p>Calling this method will repeatedly call <strong>simulate_single_iteration</strong> for
both the “null” model and the “effect” model.</p>
<p>Arguments:</p>
<p><em>iterations</em> —- number of iterations to perform (positive int, default 1000)</p>
<p><em>progress_bar</em> —- whether or not to display a progress bar in the terminal (bool, default True)</p>
<p><em>two_tailed</em> —- whether or not to use two-tailed inference (bool, default False)</p>
<p>Outputs:</p>
<p><em>results</em> —- a results object (power1d.results.SimulationResults)</p>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">power1d</span>

<span class="n">J</span>        <span class="o">=</span> <span class="mi">8</span>
<span class="n">Q</span>        <span class="o">=</span> <span class="mi">101</span>
<span class="n">baseline</span> <span class="o">=</span> <span class="n">power1d</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">Null</span><span class="p">(</span> <span class="n">Q</span><span class="o">=</span><span class="n">Q</span> <span class="p">)</span>
<span class="n">signal0</span>  <span class="o">=</span> <span class="n">power1d</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">Null</span><span class="p">(</span> <span class="n">Q</span><span class="o">=</span><span class="n">Q</span> <span class="p">)</span>
<span class="n">signal1</span>  <span class="o">=</span> <span class="n">power1d</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">GaussianPulse</span><span class="p">(</span> <span class="n">Q</span><span class="o">=</span><span class="n">Q</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">fwhm</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">amp</span><span class="o">=</span><span class="mf">1.0</span> <span class="p">)</span>
<span class="n">noise</span>    <span class="o">=</span> <span class="n">power1d</span><span class="o">.</span><span class="n">noise</span><span class="o">.</span><span class="n">Gaussian</span><span class="p">(</span> <span class="n">J</span><span class="o">=</span><span class="n">J</span><span class="p">,</span> <span class="n">Q</span><span class="o">=</span><span class="n">Q</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">0.3</span> <span class="p">)</span>
<span class="n">model0</span>   <span class="o">=</span> <span class="n">power1d</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">DataSample</span><span class="p">(</span><span class="n">baseline</span><span class="p">,</span> <span class="n">signal0</span><span class="p">,</span> <span class="n">noise</span><span class="p">,</span> <span class="n">J</span><span class="o">=</span><span class="n">J</span><span class="p">)</span>
<span class="n">model1</span>   <span class="o">=</span> <span class="n">power1d</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">DataSample</span><span class="p">(</span><span class="n">baseline</span><span class="p">,</span> <span class="n">signal1</span><span class="p">,</span> <span class="n">noise</span><span class="p">,</span> <span class="n">J</span><span class="o">=</span><span class="n">J</span><span class="p">)</span>

<span class="n">emodel0</span>  <span class="o">=</span> <span class="n">power1d</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">Experiment</span><span class="p">(</span> <span class="p">[</span><span class="n">model0</span><span class="p">,</span> <span class="n">model0</span><span class="p">],</span> <span class="n">fn</span><span class="o">=</span><span class="n">power1d</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">t_2sample</span> <span class="p">)</span>
<span class="n">emodel1</span>  <span class="o">=</span> <span class="n">power1d</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">Experiment</span><span class="p">(</span> <span class="p">[</span><span class="n">model0</span><span class="p">,</span> <span class="n">model1</span><span class="p">],</span> <span class="n">fn</span><span class="o">=</span><span class="n">power1d</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">t_2sample</span> <span class="p">)</span>

<span class="n">sim</span>      <span class="o">=</span> <span class="n">power1d</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">ExperimentSimulator</span><span class="p">(</span><span class="n">emodel0</span><span class="p">,</span> <span class="n">emodel1</span><span class="p">)</span>
<span class="n">results</span>  <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="n">iterations</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">progress_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="n">results</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../API/models-8.py">Source code</a>, <a class="reference external" href="../API/models-8.png">png</a>, <a class="reference external" href="../API/models-8.hires.png">hires.png</a>, <a class="reference external" href="../API/models-8.pdf">pdf</a>)</p>
<figure class="align-default">
<img alt="../_images/models-8.png" class="plot-directive" src="../_images/models-8.png" />
</figure>
</dd></dl>

</dd></dl>

</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">power1d.models</a><ul>
<li><a class="reference internal" href="#datasample-from-array">datasample_from_array</a></li>
<li><a class="reference internal" href="#datasample">DataSample</a></li>
<li><a class="reference internal" href="#experiment">Experiment</a></li>
<li><a class="reference internal" href="#experimentsimulator">ExperimentSimulator</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="io.html"
                          title="previous chapter">power1d.io</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="noise.html"
                          title="next chapter">power1d.noise</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/API/models.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="noise.html" title="power1d.noise"
             >next</a> |</li>
        <li class="right" >
          <a href="io.html" title="power1d.io"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">power1d 0.1.7 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../API.html" >API</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">power1d.models</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2023, Todd Pataky.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.0.2.
    </div>
  </body>
</html>